.. _mbp15_late_2013:

============================
MacBook Pro 15" Late 2013
============================

我的虚拟化测试实践主要在我很久以前购买的的MacBook Pro 15" Late 2013上完成的，这台笔记本陪伴了我7、8年，经历过各种macOS和Linux版本的折腾。

大约使用5年多时候，笔记本电池鼓包，在Apple Store更换了电池组件(这款笔记本电池和键盘、触摸板是一体的，整体替换花费1500元)。

规格
======

- Apple型号: A1398 (Model ID: MacBookPro11,3)

- 预装操作系统: MacOS X 10.9 ，目前支持最新操作系统版本(2021年为 macOS Big Sur 11.2.3)

- 整机重量: 2.02 kg

- 处理器

  - 22nm Haswell/Crystalwell 2.3GHz :ref:`intel_core_i7_4850hq`
  - 4个处理器核心支持超线程(Hyper Threading)，相当于8个虚拟核心
  - 每个处理器核心有一个独立32k L1缓存(32k x4)
  - 每个处理器核心有一个独立的256k L2缓存(256k x4)
  - 6MB共享L3缓存
  - 支持Turbo Boost 2.0(最高3.5GHz)

- 内存

  - 16GB 1600MHz DDR3L SDRAM

- 存储

  - 存储接口: PCIe 2.0x2
  - 512GB PCIe SSD

.. note::

   PCIe 2.0接口单通道500MB/s，所以对于PCIe 2.0x2可以达到 1GB/s 传输速率。理论上16-lane PCIe接口(x16)可以合并传输最高8GB/s。

   由于MacBook Pro 15" late 2013的存储接口最大传输速率1GB/s，所以在选购存储设备时可以按接口规格挑选，没有必要使用最高速NVMe，以免浪费性能(资金)

- 显卡

  - 独立显卡: NVIDIA GeForce GT 750M, 2GB显存(GDDR5)
  - 集成显卡: Intel Iris 5200 Pro, 128MB Crystalwell

- 屏幕

  - 2880x1800(220 ppi) Retina显示屏(LED背光)

- 接口

  - 802.11ac Wi-Fi
  - Bluetouch 4.0
  - 2个USB 3.0接口
  - 2个雷电2接口
  - 1个HDMI接口
  - 一个3.5耳机接口
  - 一个SDXC读卡接口

存储替换
============

2020年底，在这台MacBook Pro使用7年之后，当我尝试重装macOS系统，发现安装过程自检始终无法通过磁盘 SMART 检测。这导致macOS的installer拒绝安装。

我怀疑是因为主机磁盘使用年限导致的误判，因为在重装系统之前，我使用这个磁盘系统没有任何问题，读写完全正常。但是安装程序自检SMART算法可能还有关于磁盘通电时间的检查。目前，在这台MacBook Pro上安装使用Linux完全没有问题，只是再也无法安装macOS了。

我考虑如果后续还在这个笔记本上使用macOS的话，就购买新的第三方存储来替换。经过一些文档阅读，了解如下：

- 苹果笔记本2013年至2015年生产的全系列都支持NVMe协议，可以使用第三方 ``NVMe盘+转接头`` 替换苹果笔记本SSD硬盘。(2016年后期只有 ``不带Touch Bar`` 的13存MacBook Pro具备可拆卸SSD)
- 务必根据苹果笔记本存储接口来选购NVMe固态硬盘，过高性能规格实际上可能无法发挥性能且价格昂贵。例如，我的MacBook Pro 15" Late 2013 只支持PCIe3.0x2，所以不选PCIe3.0x4的固态硬盘。一方面节约经费，另一方面也避免了PCIE3.0x4的NVMe固态硬盘高发热量。
- 操作系统版本必须是 MacOS10.12.5以上
- 可以使用常规M.2 SSD 来升级苹果SSD，但必须注意以下坑：

  - 转换接口需要匹配苹果SSD的接口，需要注意不同代苹果接口不同 - 例如，我的 MacBook Pro 15" Late 2013是第三代接口(3A)
  - 转换接口需要配合支持的SSD品牌和型号，例如三星970 EVO PLUS就不受很多转换接口支持，而三星960 EVO就可以；
  - 新买的M.2 SSD中缺少苹果SSD数据，会失去休眠功能。解决方法通常只需要在Terminal中输入简单的命令即可恢复
  - SSD安装之前请备份现有系统，并制作系统安装U盘，因为新装入的SSD是空的，是不能使用网络恢复模式来安装系统的

目前(2021年8月)，市场上主流M.2固态硬盘大多是PCIe3.0x4规格，但价格极高。可以选择廉价的SanDisk X600系列M.2 2280（22x88mm）固态硬盘:

  - 128G => 135元
  - 256G => 199元
  - 512G => 358元

淘宝上也有直接出售 ``苹果代用盘`` 也就是整套出售M.2固态硬盘和转接卡，采用西部数据或者三星存储，价格 512G 是 479元

西部数据官方旗舰店 WD Blue SN550 NVME SSD (2280规格，PCIex4) 1TB目前性价比最高 769元 (500G 售价 429元 / 250G 售价 309元)：顺序写入速度 2260MB/s

西部数据还有售价稍低：

- WD SN500 MVME SSD 500G 售价 479元 : 顺序写入速度 530MB/s 顺序读取速度 560MB/s
- WD Green SN350 NMME SSD (PCIex2?) 480G 售价 389元 (这个系列是低功耗产品)

淘宝上出售 NVMe PCIe M.2 转苹果SSD转接卡 (适用2013年-2015年MacBook Pro/Air) 售价约15元，不过都是杂牌，没有大厂。

苹果A1398主机原装SSD配硬盘盒
============================

很不幸，苹果的专用接口SSD硬盘配套硬盘盒市场实在太小了，从淘宝上几乎很难找到合适的硬盘盒，售价非常高，几乎可以和上文存储替换的第三方NVMe M.2固态硬盘差不多架构。所以购买配置成移动硬盘非常不划算。我找到一家最便宜的无牌硬盘盒100元，但是购买者太少了也没有评论，风险较高。另一家虽然有品牌，但是售价高达388元，看评论问题也不少。所以，我不推荐搞成外界移动硬盘。

目前只是考虑如果要重装macOS才会更换内置SSD存储，但是目前我只是使用Linux，暂时无替换需求。

参考
======

- `Apple MacBook Pro 15-Inch "Core i7" 2.3 Late 2013 (DG) Specs <https://everymac.com/systems/apple/macbook_pro/specs/macbook-pro-core-i7-2.3-15-dual-graphics-late-2013-retina-display-specs.html>`_
- `装机实录 篇四：给老版MacbookAir换上一个“鸡血”固态硬盘 <https://post.smzdm.com/p/akmr0n29/>`_
- `苹果SSD固态硬盘不完全详解 <https://zhuanlan.zhihu.com/p/181847648>`_ 非常详尽的苹果SSD固态硬盘规格汇总
