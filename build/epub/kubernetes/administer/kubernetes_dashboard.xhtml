<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Kubernetes仪表盘</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="kubernetes">
<span id="kubernetes-dashboard"></span><h1>Kubernetes仪表盘</h1>
<p><a class="reference external" href="https://github.com/kubernetes/dashboard">kubenetes dashboard</a><span class="link-target"> [https://github.com/kubernetes/dashboard]</span> 是通用用途的基于WEB的Kubenetes集群管理平台，可以管理集群以及运行在集群中的应用程序。</p>
<section id="dashboard">
<h2>dashboard起步</h2>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>请参考官方网站安装最新的稳定版本，或者从 <a class="reference external" href="https://github.com/kubernetes/dashboard/releases">dashboard release 页面</a><span class="link-target"> [https://github.com/kubernetes/dashboard/releases]</span> 检查需要的版本进行安装。</p>
</div>
<p>安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">dashboard</span><span class="o">/</span><span class="n">v1</span><span class="o">.</span><span class="mf">10.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">deploy</span><span class="o">/</span><span class="n">recommended</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>然后在本地服务器上通过以下命令创建安全通道访问集群:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kubectl</span> <span class="n">proxy</span>
</pre></div>
</div>
<p>建立安全通道之后，就可以访问Dashboard:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8001</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span><span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">https</span><span class="p">:</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="p">:</span><span class="o">/</span><span class="n">proxy</span><span class="o">/</span>
</pre></div>
</div>
</section>
<section id="minikube-dashboard">
<h2>minikube dashboard</h2>
<p>在minikube中 <a class="reference internal" href="../startup_prepare/install_run_minikube.xhtml#minikube-dashboard"><span class="std std-ref">启动dashboard</span></a> 可以帮助我们学习和了解kubernetes系统，本文将详细解析这个开源的Kubernetes仪表盘的部署和运维，以及自己的一些使用经验。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>注意在minikube中默认没有启用dashboard，启动和访问dashboard的方法请参考 <a class="reference internal" href="../startup_prepare/install_run_minikube.xhtml#minikube-dashboard"><span class="std std-ref">启动dashboard</span></a> 。</p>
<p>但是，dashboard实际上是在kubectl所在客户端运行的一个仪表盘服务，原理是通过本地kubectl去连接Kubernetes集群，获取集群数据并实时在本地的dashboard上</p>
</div>
<section id="id1">
<h3>启动minikube dashboard异常排查</h3>
<p>在 <a class="reference internal" href="../startup_prepare/install_run_minikube.xhtml#install-run-minikube"><span class="std std-ref">安装和运行minikube</span></a> 时采用了裸物理主机运行minikube，几经波折运行成功。但是在启动 dashboard 时候遇到异常:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">minikube</span> <span class="n">dashboard</span> <span class="o">--</span><span class="n">url</span>
</pre></div>
</div>
<p>显示错误:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">33073</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span><span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">http</span><span class="p">:</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="p">:</span><span class="o">/</span><span class="n">proxy</span><span class="o">/</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">responding</span> <span class="n">properly</span><span class="p">:</span> <span class="n">Temporary</span> <span class="n">Error</span><span class="p">:</span> <span class="n">unexpected</span> <span class="n">response</span> <span class="n">code</span><span class="p">:</span> <span class="mi">503</span>
</pre></div>
</div>
<p>此时检查pod状态:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">--</span><span class="nb">all</span><span class="o">-</span><span class="n">namespaces</span>
</pre></div>
</div>
<p>输出显示pod始终时创建状态:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NAMESPACE</span>     <span class="n">NAME</span>                                   <span class="n">READY</span>   <span class="n">STATUS</span>              <span class="n">RESTARTS</span>   <span class="n">AGE</span>
<span class="o">...</span>
<span class="n">kube</span><span class="o">-</span><span class="n">system</span>   <span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">d7c9687c7</span><span class="o">-</span><span class="n">ggrdf</span>   <span class="mi">0</span><span class="o">/</span><span class="mi">1</span>     <span class="n">ContainerCreating</span>   <span class="mi">0</span>          <span class="mi">4</span><span class="n">m1s</span>
</pre></div>
</div>
<p>不过，可以可能是首次启动原因，我发现大约9分钟以后，容器进入running状态:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">d7c9687c7</span><span class="o">-</span><span class="n">ggrdf</span>   <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>     <span class="n">Running</span>   <span class="mi">0</span>          <span class="mi">9</span><span class="n">m12s</span>
</pre></div>
</div>
<p>此时通过浏览器访问 <a class="reference external" href="http://127.0.0.1:8001/api/v1/namespaces/kube-system/services/http:kubernetes-dashboard:/proxy/">http://127.0.0.1:8001/api/v1/namespaces/kube-system/services/http:kubernetes-dashboard:/proxy/</a> 则恢复正常。</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>