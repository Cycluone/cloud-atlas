<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>安装MySQL</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="mysql">
<span id="install-mysql"></span><h1>安装MySQL</h1>
<section id="macosmysql">
<h2>macOS上安装MySQL</h2>
<section id="id1">
<h3>MySQL官方安装包</h3>
<p>MySQL官方提供了MySQL on macOS Native Packages，可以非常方便直接安装。</p>
<ul class="simple">
<li><p>下载安装镜像(.dmg)文件，包含了MySQL软件安装共欧，双击dmg文件镜像</p></li>
<li><p>安装过程会提示输入root账号密码，输入root密码后自动安装</p></li>
<li><p>默认安装目录在 <code class="docutils literal notranslate"><span class="pre">/usr/local/mysql</span></code> ，所以需要将执行目录路径 <code class="docutils literal notranslate"><span class="pre">/usr/local/mysql/bin</span></code> 添加到环境变量 <code class="docutils literal notranslate"><span class="pre">$PAHT</span></code> 中</p></li>
</ul>
<p>由于MySQL在macOS的安装路径 <code class="docutils literal notranslate"><span class="pre">/usr/local/mysql/lib</span></code> 不是系统默认的动态库加载目录，所以需要在环境变量中添加如下:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:/usr/local/mysql/lib
</pre></div>
</div>
<p>否则Python使用 <code class="docutils literal notranslate"><span class="pre">mysqlclient</span></code> 模块会报无法找到动态库错误(请参考 <a class="reference internal" href="../../django/startup/django_app.xhtml#django-app"><span class="std std-ref">Django 应用</span></a> )</p>
</section>
<section id="homebrew">
<h3>Homebrew安装</h3>
<ul>
<li><p>首先安装 <a class="reference internal" href="../../apple/studio/homebrew.xhtml#homebrew"><span class="std std-ref">Homebrew</span></a></p></li>
<li><p>安装mysql:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">mysql</span>
</pre></div>
</div>
</li>
<li><p>在用户路径中添加mysql:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=$PATH:/usr/local/mysql/bin
</pre></div>
</div>
</li>
<li><p>启动数据库:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">services</span> <span class="n">start</span> <span class="n">mysql</span>
</pre></div>
</div>
</li>
<li><p>数据库安全初始化:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql_secure_installation</span>
</pre></div>
</div>
</li>
</ul>
<p>移除测试数据库和匿名账号，并设置一个复杂密码。</p>
</section>
</section>
<section id="id2">
<h2>数据库初始化</h2>
<p>在 <a class="reference internal" href="../../django/index.xhtml#django"><span class="std std-ref">Django Atlas</span></a> 开发中，我采用了两种环境:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../docker/applications/docker_compose_django.xhtml#docker-compose-django"><span class="std std-ref">在Docker环境运行Django</span></a> 是先 <a class="reference internal" href="../../docker/startup/install_docker_macos.xhtml#install-docker-macos"><span class="std std-ref">macOS安装Docker</span></a> ，然后通过 <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> 实现的MySQL容器化运行</p></li>
<li><p><a class="reference internal" href="../../django/startup/django_env.xhtml#django-env"><span class="std std-ref">Django开发环境</span></a> 是在macOS上通过Python virtualenv运行Django，连接的是本地运行的一个MySQL数据库</p></li>
</ul>
<p>前者通过 <a class="reference internal" href="../../docker/index.xhtml#docker"><span class="std std-ref">Docker Atlas</span></a> 的官方镜像，支持传递环境变量就可以自动配置好MySQL数据库；但是后者则是传统的数据库维护方式，需要我们做数据库初始化才能用于 <a class="reference internal" href="../../django/index.xhtml#django"><span class="std std-ref">Django Atlas</span></a> 开发。</p>
<ul>
<li><p>在MySQL中创建数据库 <code class="docutils literal notranslate"><span class="pre">mydb</span></code> 并创建 <code class="docutils literal notranslate"><span class="pre">myapp_user</span></code> 账号及对应密码 <code class="docutils literal notranslate"><span class="pre">myapp_passwd</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="n">database</span> <span class="n">mydb</span> <span class="n">characterset</span> <span class="n">utf8</span><span class="p">;</span>

<span class="n">grant</span> <span class="n">usage</span> <span class="n">on</span> <span class="n">mydb</span><span class="o">.*</span> <span class="n">to</span> <span class="n">myapp_user</span><span class="o">@</span><span class="s1">&#39;%&#39;</span> <span class="n">identified</span> <span class="n">by</span> <span class="s1">&#39;myapp_passwd&#39;</span><span class="p">;</span>

<span class="n">grant</span> <span class="nb">all</span> <span class="n">privileges</span> <span class="n">on</span> <span class="n">mydb</span><span class="o">.*</span> <span class="n">to</span> <span class="n">myapp_user</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span>

<span class="n">flush</span> <span class="n">privileges</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id3">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/osx-installation-pkg.html">Installing MySQL on macOS Using Native Packages</a><span class="link-target"> [https://dev.mysql.com/doc/refman/8.0/en/osx-installation-pkg.html]</span></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>