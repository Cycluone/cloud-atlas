<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>在VS Code中使用Python virtualenv</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="vs-codepython-virtualenv">
<span id="vs-code-virtualenv"></span><h1>在VS Code中使用Python virtualenv</h1>
<p>在Python中所谓”环境”是指Python程序的运行上下文。Python环境包含了Python解释器和一系列安装的Python包。VS Code的Python扩展提供了不同环境的有效集成工作功能。</p>
<section id="id1">
<h2>选择和激活环境</h2>
<p>默认情况下，Python扩展会搜索和使用在系统目录中找到的第一个Python解释器。如果VS Code没有找到任何解释器，就会提示一个警告。在macOS中，VS Code扩展也会在使用系统预装Python解释器时候提示一个警告，因为通常用户都是直接安装使用解释器。不管哪种情况，你都可以通过设置 <code class="docutils literal notranslate"><span class="pre">python.disableInstallationCheck</span></code> 为 <code class="docutils literal notranslate"><span class="pre">true</span></code> 来关闭告警。</p>
<ul class="simple">
<li><p>选择指定环境，在 <code class="docutils literal notranslate"><span class="pre">Command</span> <span class="pre">Palete</span></code> ( <code class="docutils literal notranslate"><span class="pre">⇧⌘P</span></code> )中选择使用 <code class="docutils literal notranslate"><span class="pre">Python:Select</span> <span class="pre">Interpreter</span></code></p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/select-interpreters-command.png" src="../../_images/select-interpreters-command.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>扩展自动从以下位置查找解释器:</p>
<ul class="simple">
<li><p>标准安装目录，如 <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code> , <code class="docutils literal notranslate"><span class="pre">/usr/sbin</span></code> , <code class="docutils literal notranslate"><span class="pre">/sbin</span></code> , <code class="docutils literal notranslate"><span class="pre">c:\\python27</span></code> , <code class="docutils literal notranslate"><span class="pre">c:\\python36</span></code> 等</p></li>
<li><p>在workspace(项目)目录下直接定位虚拟环境</p></li>
<li><p>在General settings中设置 <code class="docutils literal notranslate"><span class="pre">python.venvPath</span></code> 指定Python虚拟环境，这个设置可以包含多个虚拟环境。扩展会查看 <code class="docutils literal notranslate"><span class="pre">venvPath</span></code> 的5层子目录中的虚拟环境</p></li>
<li><p>对 <a class="reference external" href="https://virtualenvwrapper.readthedocs.io/">virtualenvwrapper</a><span class="link-target"> [https://virtualenvwrapper.readthedocs.io/]</span> 的 <code class="docutils literal notranslate"><span class="pre">~/.virtualenvs</span></code> 指定目录的虚拟环境</p></li>
<li><p>通过 <a class="reference external" href="https://github.com/pyenv/pyenv">pyenv</a><span class="link-target"> [https://github.com/pyenv/pyenv]</span> 安装的解析器</p></li>
<li><p>为 <a class="reference external" href="https://virtualenvwrapper.readthedocs.io/">virtualenvwrapper</a><span class="link-target"> [https://virtualenvwrapper.readthedocs.io/]</span> 使用的通过 <code class="docutils literal notranslate"><span class="pre">WORKON_HOME</span></code> 指定的路径中的虚拟环境</p></li>
<li><p>Conda环境包含的Python解析器</p></li>
<li><p>在workspace(项目)目录下的 <code class="docutils literal notranslate"><span class="pre">.direnv</span></code> 目录下安装的解析器</p></li>
</ul>
</div>
<p>我使用 General settings中设置 <code class="docutils literal notranslate"><span class="pre">python.venvPath</span></code> 指定Python虚拟环境:</p>
<figure class="align-default">
<img alt="../../_images/vscode_venv_path.png" src="../../_images/vscode_venv_path.png" />
</figure>
<p>在 Workspace Settings中设置 <code class="docutils literal notranslate"><span class="pre">python.pythonPath</span></code> 中设置好自己的解析器(原先设置内容是 <code class="docutils literal notranslate"><span class="pre">python</span></code> ，修订成 <code class="docutils literal notranslate"><span class="pre">~/venv3/bin/python</span></code> ):</p>
<figure class="align-default">
<img alt="../../_images/vscode_pythonpath.png" src="../../_images/vscode_pythonpath.png" />
</figure>
<p>这两个配置完成后，检查 <code class="docutils literal notranslate"><span class="pre">$HOME/Library/Application\</span> <span class="pre">Support/Code/User/settings.json</span></code> 可以看到如下配置:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="s2">&quot;python.venvPath&quot;</span><span class="p">:</span> <span class="s2">&quot;~/venv3&quot;</span><span class="p">,</span>
<span class="s2">&quot;python.pythonPath&quot;</span><span class="p">:</span> <span class="s2">&quot;~/venv3/bin/python&quot;</span><span class="p">,</span>
<span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li><p>完成以上 <code class="docutils literal notranslate"><span class="pre">python.venvPath</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python.pythonPath</span></code> 设置之后， <code class="docutils literal notranslate"><span class="pre">需要重启一次VS</span> <span class="pre">Code</span></code> ，然后使用 <code class="docutils literal notranslate"><span class="pre">Python:Select</span> <span class="pre">Interpreter</span></code> 就会看到默认的解释器就是虚拟环境中的Python了： <code class="docutils literal notranslate"><span class="pre">~/venv3/bin/python</span></code></p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/current_python_interpreter.png" src="../../_images/current_python_interpreter.png" />
</figure>
<p>上述设置之后，在 VS Code中启动一个内建的Terminal可以看到如下输出:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">huatai</span><span class="o">/</span><span class="n">venv3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="n">huatai</span><span class="nd">@my</span><span class="o">-</span><span class="n">studio</span> <span class="n">onesre</span> <span class="o">%</span> <span class="n">source</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">huatai</span><span class="o">/</span><span class="n">venv3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="p">(</span><span class="n">venv3</span><span class="p">)</span> <span class="n">huatai</span><span class="nd">@my</span><span class="o">-</span><span class="n">studio</span> <span class="n">onesre</span> <span class="o">%</span>
</pre></div>
</div>
<p>则证明已经启动Python Virtualenv环境，并且在Terminal中执行 <code class="docutils literal notranslate"><span class="pre">python</span></code> 进入交互模式，并执行 <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">模块名</span></code> 检查你之前安装过的模块，例如 <a class="reference internal" href="../../django/index.xhtml#django"><span class="std std-ref">Django Atlas</span></a> 不应该有任何报错。</p>
</section>
<section id="id3">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://code.visualstudio.com/docs/python/environments">Using Python environments in VS Code</a><span class="link-target"> [https://code.visualstudio.com/docs/python/environments]</span></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>