<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Docker Compose</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="docker-compose">
<span id="id1"></span><h1>Docker Compose</h1>
<p>Compose是一个定义运行多个容器Docker应用程序，通过Compose，可以使用一个YAML文件来配置应用程序的服务，然后通过一个单一命令，可以根据配置创建和启动所有服务。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>有点类似Kubernetes的Pod，可以定义一组容器相互关联。</p>
</div>
<p>Compose可以工作在所有环境：production, staging, development, testing, 类似的CI工作流。</p>
<p>使用Compose有3个基本步骤：</p>
<ul class="simple">
<li><p>使用一个 <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> 定义应用程序环境，这样它能够在任何地方重新运行</p></li>
<li><p>在 <code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> 文件中定义服务来启动app，这样这些应用可以在一个隔离环境中一起运行</p></li>
<li><p>使用 <code class="docutils literal notranslate"><span class="pre">docker-compose</span> <span class="pre">up</span></code> 启动和运行完整的应用组合</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> 案例如下:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">version</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span>
<span class="n">services</span><span class="p">:</span>
  <span class="n">web</span><span class="p">:</span>
    <span class="n">build</span><span class="p">:</span> <span class="o">.</span>
    <span class="n">ports</span><span class="p">:</span>
    <span class="o">-</span> <span class="s2">&quot;5000:5000&quot;</span>
    <span class="n">volumes</span><span class="p">:</span>
    <span class="o">-</span> <span class="o">.</span><span class="p">:</span><span class="o">/</span><span class="n">code</span>
    <span class="o">-</span> <span class="n">logvolume01</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span>
    <span class="n">links</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">redis</span>
  <span class="n">redis</span><span class="p">:</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">redis</span>
<span class="n">volumes</span><span class="p">:</span>
  <span class="n">logvolume01</span><span class="p">:</span> <span class="p">{}</span>
</pre></div>
</div>
<section id="id2">
<h2>安装Docker Compose</h2>
<p>Docker Compose依赖Docker Engine工作，所以需要先确保Docker Engine已经在本地或者远程服务器上安装好。</p>
<ul class="simple">
<li><p>在 <a class="reference internal" href="install_docker_macos.xhtml#install-docker-macos"><span class="std std-ref">macOS安装Docker</span></a> Desktop for Mac 或者 for Windows，则Docker Compose已经作为安装的程序组件一起安装了</p></li>
<li><p>在Linux系统中，首先通过发行版安装 <code class="docutils literal notranslate"><span class="pre">docker</span></code> ，然后再按照下面介绍的步骤安装Compose</p></li>
<li><p>在Linux系统中，可以设置 <a class="reference internal" href="install_docker_linux.xhtml#run-docker-without-sudo"><span class="std std-ref">无需sudo运行docker</span></a> Compose</p></li>
</ul>
<section id="macoscompose">
<h3>在macOS中安装Compose</h3>
<p>参考 <a class="reference internal" href="install_docker_macos.xhtml#install-docker-macos"><span class="std std-ref">macOS安装Docker</span></a> 就可以获得Compose</p>
</section>
<section id="linuxcompose">
<h3>在Linux中安装Compose</h3>
<p>Linux平台下，需要从 <a class="reference external" href="https://github.com/docker/compose/releases">Compose repository release page on GitHub</a><span class="link-target"> [https://github.com/docker/compose/releases]</span> 下载安装，使用 <code class="docutils literal notranslate"><span class="pre">curl</span></code> 命令:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="s2">&quot;https://github.com/docker/compose/releases/download/1.25.0/docker-compose-$(uname -s)-$(uname -m)&quot;</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span>

<span class="n">sudo</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span>
</pre></div>
</div>
</section>
<section id="compose">
<h3>升级Compose</h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">migrate</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">labels</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>卸载Compose</h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">rm</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.docker.com/compose/">Overview of Docker Compose</a><span class="link-target"> [https://docs.docker.com/compose/]</span></p></li>
<li><p><a class="reference external" href="https://docs.docker.com/compose/install/">Install Docker Compose</a><span class="link-target"> [https://docs.docker.com/compose/install/]</span></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>