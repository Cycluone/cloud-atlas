<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>macOS安装Docker</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="macosdocker">
<span id="install-docker-macos"></span><h1>macOS安装Docker</h1>
<section id="docker-desktop-on-mac-vs-docker-toolbox">
<h2>Docker Desktop on Mac vs. Docker Toolbox</h2>
<section id="docker-toolbox">
<h3>Docker Toolbox</h3>
<p>早期在Mac OS X上运行Docker实际上是先在OS X上安装运行VirtualBox，然后在VirtualBox中运行一个Linux虚拟机，最后Docker实际上是运行在Linux虚拟机中。而在Mac OS X上执行的 <code class="docutils literal notranslate"><span class="pre">docker</span></code> 指令则通过虚拟网络访问远程虚拟机内的Docker服务来实现管理。这种运行模式，在Mac上的 <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code> 目录下安装了 <code class="docutils literal notranslate"><span class="pre">docker</span></code> ， <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> 和 <code class="docutils literal notranslate"><span class="pre">docker-machine</span></code> 。Toolbox会使用
<code class="docutils literal notranslate"><span class="pre">docker-machine</span></code> 来提供VirtualBox VM，虚拟机命名为 <code class="docutils literal notranslate"><span class="pre">default</span></code> ，并运行一个 <code class="docutils literal notranslate"><span class="pre">boot2docker</span></code> 的Linux发行版。</p>
<p>在执行 <code class="docutils literal notranslate"><span class="pre">docker</span></code> 和 <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> 命令之前，通常已经执行了环境设置命令 <code class="docutils literal notranslate"><span class="pre">eval</span> <span class="pre">$(docker-machine</span> <span class="pre">env</span> <span class="pre">default)</span></code> ，这样 <code class="docutils literal notranslate"><span class="pre">docker</span></code> 或 <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> 就知道如何与VirtualBox中的Docker Engine通讯。</p>
<figure class="align-default">
<img alt="../../_images/toolbox-install.png" src="../../_images/toolbox-install.png" style="width: 492.0px; height: 251.5px;" />
</figure>
</section>
<section id="docker-desktop-on-mac">
<h3>Docker Desktop on Mac</h3>
<p>现在推荐采用Docker Desktop on Mac模式来运行Mac-native模式的Docker，也就是安装在 <code class="docutils literal notranslate"><span class="pre">/Applications</span></code> 中，实际上是创建了一个完整的application bundle，位于 <code class="docutils literal notranslate"><span class="pre">/Applications/Docker.app/Contents/Resources/bin</span></code> 。</p>
<p>Docker Desktop on Mac的关键技术:</p>
<ul class="simple">
<li><p>使用 <a class="reference external" href="https://github.com/docker/HyperKit/">Docker HyperKit</a><span class="link-target"> [https://github.com/docker/HyperKit/]</span> 代替了 VirtualBox。Hyperkit是轻量级的macOS虚拟化解决方案，基于macOS 10.10 Yosemite或更高版本的Hypervisor.framework。</p></li>
<li><p>Docker Desktop不再使用 <code class="docutils literal notranslate"><span class="pre">docker-machine</span></code> 来构建VM，而Docker Engine API是直接在Mac主机的 <code class="docutils literal notranslate"><span class="pre">/var/run/docker.sock</span></code> 提供socket，这也是默认的Docker和Docker Compose客户端使用连接到Docker dameon的连接。</p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/docker-for-mac-install.png" src="../../_images/docker-for-mac-install.png" style="width: 488.5px; height: 278.0px;" />
</figure>
</section>
</section>
<section id="id1">
<h2>安装Docker Desktop on Mac</h2>
<p>从Docker Hub登陆账号后下载 <a class="reference external" href="https://download.docker.com/mac/stable/Docker.dmg">Docker Desktop</a><span class="link-target"> [https://download.docker.com/mac/stable/Docker.dmg]</span> : <a class="reference external" href="https://hub.docker.com/?overlay=onboarding">Download from Docker Hub</a><span class="link-target"> [https://hub.docker.com/?overlay=onboarding]</span></p>
<ul class="simple">
<li><p>通过拖放将Docker安装到Applications</p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/docker-app-drag.png" src="../../_images/docker-app-drag.png" style="width: 361.0px; height: 150.0px;" />
</figure>
<ul class="simple">
<li><p>点击启动Docker应用，此时会提示需要权限</p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/docker_privileged_access.png" src="../../_images/docker_privileged_access.png" style="width: 400.0px; height: 127.0px;" />
</figure>
<p>确认权限之后，docker进入启动</p>
<figure class="align-default">
<img alt="../../_images/docker_starting.png" src="../../_images/docker_starting.png" style="width: 251.5px; height: 400.0px;" />
</figure>
<p>完成启动后，可以按照提示执行以下命令验证:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">info</span>
<span class="n">docker</span> <span class="n">version</span>
<span class="n">docker</span> <span class="n">images</span>
<span class="n">docker</span> <span class="n">run</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span>
<span class="n">docker</span> <span class="n">ps</span>
</pre></div>
</div>
<ul>
<li><p>Docker Hub官方提供了一个验证案例，可以参考以下命令验证:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">docker</span><span class="o">/</span><span class="n">doodle</span><span class="o">.</span><span class="n">git</span>
<span class="c1"># 构建docker镜像(请查看Dockerfile)</span>
<span class="n">cd</span> <span class="n">doodle</span><span class="o">/</span><span class="n">cheers2019</span> <span class="o">&amp;&amp;</span> <span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="n">huataihuang</span><span class="o">/</span><span class="n">cheers2019</span> <span class="o">.</span>
<span class="c1"># 运行容器</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">rm</span> <span class="n">huataihuang</span><span class="o">/</span><span class="n">cheers2019</span>
<span class="c1"># 登陆docker Hub并将自己的镜像推送入仓库</span>
<span class="n">docker</span> <span class="n">login</span> <span class="o">&amp;&amp;</span> <span class="n">docker</span> <span class="n">push</span> <span class="n">huataihuang</span><span class="o">/</span><span class="n">cheers2019</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>查看目录下的 <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> 可以看到这是一个简单绘制ASCII图形的Go程序，提供了一个运行案例。上述案例完整体现了一个如何构建自己的Docker程序并推送到Docker Hub的实例，也是今后构建自己的应用程序的一个良好模版，简单高效。</p>
</div>
</section>
<section id="docker-vm-on-macos">
<h2>Docker VM on macOS</h2>
<p>我们知道Docker容器需要使用Linux内核才能够运行，在Mac系统中要获得Linux内核，需要使用hypervsor</p>
</section>
<section id="id2">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.docker.com/docker-for-mac/install/">Install Docker Desktop on Mac</a><span class="link-target"> [https://docs.docker.com/docker-for-mac/install/]</span></p></li>
<li><p><a class="reference external" href="https://docs.docker.com/docker-for-mac/docker-toolbox/">Docker Desktop on Mac vs. Docker Toolbox</a><span class="link-target"> [https://docs.docker.com/docker-for-mac/docker-toolbox/]</span></p></li>
<li><p><a class="reference external" href="https://ekartco.com/2019/12/enter-docker-vm-on-macos-catalina-ssh-xhyve/">Enter Docker VM on MacOS Catalina (SSH, xhyve)</a><span class="link-target"> [https://ekartco.com/2019/12/enter-docker-vm-on-macos-catalina-ssh-xhyve/]</span></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>