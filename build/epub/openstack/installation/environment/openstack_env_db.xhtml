<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>OpenStack环境数据库</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="openstack">
<span id="openstack-env-db"></span><h1>OpenStack环境数据库</h1>
<p>OpenStack使用SQL数据库存储大多数信息，数据库可以安装在管控服务器上，也可以独立部署（适合更大规模集群）。常用数据库可以采用 MariaDB或MySQL数据库，此外OpenStack也支持PostgreSQL数据库。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>初次安装部署可以采用简化安装MySQL系统，后续升级成采用 <a class="reference internal" href="../../../mysql/vitess/deploy/run_vitess_locally.xhtml#run-vitess-locally"><span class="std std-ref">本地运行Vitess</span></a> 集成高可用MySQL集群。</p>
<p>案例首次安装在 <code class="docutils literal notranslate"><span class="pre">worker1</span></code> 服务器上安装单机版 mariadb。</p>
</div>
<section id="id1">
<h2>安装和配置数据库</h2>
<ul>
<li><p>安装数据库软件包:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">mariadb</span> <span class="n">mariadb</span><span class="o">-</span><span class="n">server</span> <span class="n">python2</span><span class="o">-</span><span class="n">PyMySQL</span>
</pre></div>
</div>
</li>
<li><p>创建 <code class="docutils literal notranslate"><span class="pre">/etc/my.cnf.d/openstack.cnf</span></code> 配置文件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">mysqld</span><span class="p">]</span>
<span class="n">bind</span><span class="o">-</span><span class="n">address</span> <span class="o">=</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span>

<span class="n">default</span><span class="o">-</span><span class="n">storage</span><span class="o">-</span><span class="n">engine</span> <span class="o">=</span> <span class="n">innodb</span>
<span class="n">innodb_file_per_table</span> <span class="o">=</span> <span class="n">on</span>
<span class="n">max_connections</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="n">collation</span><span class="o">-</span><span class="n">server</span> <span class="o">=</span> <span class="n">utf8_general_ci</span>
<span class="n">character</span><span class="o">-</span><span class="nb">set</span><span class="o">-</span><span class="n">server</span> <span class="o">=</span> <span class="n">utf8</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>这里 <code class="docutils literal notranslate"><span class="pre">bind-address</span></code> 是物理主机 <code class="docutils literal notranslate"><span class="pre">worker1</span></code> 的网卡地址，OpenStack将使用这个绑定地址来访问数据库。</p>
</div>
<ul>
<li><p>启动数据库服务:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">mariadb</span><span class="o">.</span><span class="n">service</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">mariadb</span><span class="o">.</span><span class="n">service</span>
</pre></div>
</div>
</li>
<li><p>执行 <code class="docutils literal notranslate"><span class="pre">mysql_secure_installation</span></code> 脚本设置数据库安全:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql_secure_installation</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>