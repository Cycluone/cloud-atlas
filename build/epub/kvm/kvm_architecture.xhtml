<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>KVM虚拟化</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="kvm">
<span id="kvm-architecture"></span><h1>KVM虚拟化</h1>
<p>KVM(Kernel-based Virtual Machine)，是内建在Linux Kernel中的hypervisor。相对于另一种开源虚拟化Xen，KVM更为简单和易用，并且和原生QEMU不同，KVM通过一个内核模块使用CPU硬件扩展(HVM)来运行一个特殊运行模式的QEMU。</p>
<p>通过KVM，可以在Host物理主机上运行多种无需修改的操作系统(Linux, Windows, 甚至macOS)，每个额虚拟机都有自己私有的虚拟硬件：网卡、磁盘、显卡等等。注意，KVM和Xen不同之处是KVM是作为Linux的一部分，采用了常规的Linux调度和内存管理，所以更为小巧和易于使用。同时KVM仅支持x86 hvm(vt/svm指令集)，不需要修改Guest操作系统，所以KVM并不支持paravirtualation for CPU，但是KVM为了提高I/O性能，支持paravirtualization for device drivers(驱动半虚拟化)。</p>
<ul>
<li><p>检查虚拟化支持情况:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LC_ALL</span><span class="o">=</span><span class="n">C</span> <span class="n">lscpu</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">Virtualization</span>
</pre></div>
</div>
</li>
</ul>
<p>输出显示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Virtualization</span><span class="p">:</span>                  <span class="n">VT</span><span class="o">-</span><span class="n">x</span>
</pre></div>
</div>
<ul>
<li><p>检查内核是否支持KVM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zgrep</span> <span class="n">CONFIG_KVM</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</li>
</ul>
<p>然后检查内核模块是否自动加载:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lsmod</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">kvm</span>
</pre></div>
</div>
<ul>
<li><p>检查内核是否支持VIRTIO(提高性能):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zgrep</span> <span class="n">VIRTIO</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</li>
</ul>
<p>然后检查是否加载了内核模块:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lsmod</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">virtio</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>在Ubuntu和Arch Linux平台安装KVM运行环境，请参考 <a class="reference internal" href="../studio/kvm_docker_in_studio.xhtml#kvm-docker-in-studio"><span class="std std-ref">Studio环境KVM和Docker</span></a></p>
</div>
<section id="id1">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://wiki.archlinux.org/index.php/KVM">Arch Linux文档 - KVM</a><span class="link-target"> [https://wiki.archlinux.org/index.php/KVM]</span></p></li>
<li><p><a class="reference external" href="https://wiki.archlinux.org/index.php/QEMU">Arch Linux文档 - QEMU</a><span class="link-target"> [https://wiki.archlinux.org/index.php/QEMU]</span></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>