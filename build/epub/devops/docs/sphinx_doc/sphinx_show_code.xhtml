<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Sphinx展示代码</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="sphinx">
<span id="sphinx-show-code"></span><h1>Sphinx展示代码</h1>
<p>在Sphinx中展示代码只需要在行末尾加上 <code class="docutils literal notranslate"><span class="pre">::</span></code> ，之后的代码部分只要缩进就可以展示。</p>
<p>Syntax高亮代码功能是通过Pygments实现的:</p>
<ul>
<li><p>每个代码段可以指定”高亮语言”，通过 <code class="docutils literal notranslate"><span class="pre">highlight::</span></code> 指令设置:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">highlight</span><span class="p">::</span> <span class="n">c</span>

   <span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>对于不同语言的代码段，也有一个 <code class="docutils literal notranslate"><span class="pre">code-block</span></code> 直接指定代码高亮语言:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">ruby</span>

   <span class="n">Some</span> <span class="n">Ruby</span> <span class="n">code</span><span class="o">.</span>
</pre></div>
</div>
</li>
</ul>
<section id="id1">
<h2>行号</h2>
<p>Pygments可以生成代码段的行号，对于需要高亮代码，需要指定 <code class="docutils literal notranslate"><span class="pre">linenothreshold</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">highlight</span><span class="p">::</span> <span class="n">python</span>
   <span class="p">:</span><span class="n">linenothreshold</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<p>使用 code-block ，有一个 <code class="docutils literal notranslate"><span class="pre">linenos</span></code> 开关选项可以启用行号:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">ruby</span>
   <span class="p">:</span><span class="n">linenos</span><span class="p">:</span>

   <span class="n">Some</span> <span class="n">more</span> <span class="n">Ruby</span> <span class="n">code</span><span class="o">.</span>
</pre></div>
</div>
<p>可以强调指定行:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
   <span class="p">:</span><span class="n">emphasize</span><span class="o">-</span><span class="n">lines</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span><span class="mi">5</span>

   <span class="k">def</span> <span class="nf">some_function</span><span class="p">():</span>
       <span class="n">interesting</span> <span class="o">=</span> <span class="kc">False</span>
       <span class="nb">print</span> <span class="s1">&#39;This line is highlighted.&#39;</span>
       <span class="nb">print</span> <span class="s1">&#39;This one is not...&#39;</span>
       <span class="nb">print</span> <span class="s1">&#39;...but this one is.&#39;</span>
</pre></div>
</div>
</section>
<section id="id2">
<h2>代码包含</h2>
<p>可以包含外部代码文件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>以下举例一个ruby代码以及高亮和行号:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="n">example</span><span class="o">.</span><span class="n">rb</span>
   <span class="p">:</span><span class="n">language</span><span class="p">:</span> <span class="n">ruby</span>
   <span class="p">:</span><span class="n">emphasize</span><span class="o">-</span><span class="n">lines</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="o">-</span><span class="mi">18</span>
   <span class="p">:</span><span class="n">linenos</span><span class="p">:</span>
</pre></div>
</div>
<p>可以指定代码的编码:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span>
   <span class="p">:</span><span class="n">encoding</span><span class="p">:</span> <span class="n">latin</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>对于Python模块，可以选择一个类、函数或方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span>
   <span class="p">:</span><span class="n">pyobject</span><span class="p">:</span> <span class="n">Timer</span><span class="o">.</span><span class="n">start</span>
</pre></div>
</div>
<p>还提供了代码 diff</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span>
   <span class="p">:</span><span class="n">diff</span><span class="p">:</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span><span class="o">.</span><span class="n">orig</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2>标题和名字</h2>
<p>命名提供了代码显示的名字:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>
   <span class="p">:</span><span class="n">caption</span><span class="p">:</span> <span class="n">this</span><span class="o">.</span><span class="n">py</span>
   <span class="p">:</span><span class="n">name</span><span class="p">:</span> <span class="n">this</span><span class="o">-</span><span class="n">py</span>

   <span class="nb">print</span> <span class="s1">&#39;Explicit is better than implicit.&#39;</span>
</pre></div>
</div>
<p>可以指定代码的缩进字符数量:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="n">example</span><span class="o">.</span><span class="n">rb</span>
   <span class="p">:</span><span class="n">language</span><span class="p">:</span> <span class="n">ruby</span>
   <span class="p">:</span><span class="n">dedent</span><span class="p">:</span> <span class="mi">4</span>
   <span class="p">:</span><span class="n">lines</span><span class="p">:</span> <span class="mi">10</span><span class="o">-</span><span class="mi">15</span>
</pre></div>
</div>
</section>
<section id="id4">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sphinx-doc.org/en/1.5/markup/code.html">Sphinx Doc: Showing code examples</a><span class="link-target"> [https://www.sphinx-doc.org/en/1.5/markup/code.html]</span></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>