<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Vim安装</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="vim">
<span id="install-vim"></span><h1>Vim安装</h1>
<p>Vim是传奇编辑器vi的继承者，功能强大但需要使用者不断训练形成 <code class="docutils literal notranslate"><span class="pre">肌肉记忆</span></code> 。在所有的Unix/Linux系统上都能够方便安装和使用，特别适合没有图形界面的远程终端开发环境。</p>
<p>使用Vim的优点:</p>
<ul class="simple">
<li><p>轻量级和随处可得: 几乎所有Linux系统都能够快速安装，无需图形界面，适合远程服务器开发(ssh登录)</p></li>
<li><p>通过简单配置备份就可以随时恢复工作环境，构建适合开发 C/Python/Go 等所有主流开发语言</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>一直以来，我都没有系统学习过Vi，虽然不断使用，但是仅限于非常基本的使用操作。不过，对于服务器开发者，这个编辑器对于提高开发效率有极大帮助，依然值得投入学习。</p>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>本文是在树莓派的Raspberry Pi OS上实践，也即是Debian Linux系统上编译安装 <code class="docutils literal notranslate"><span class="pre">vim</span></code> + <code class="docutils literal notranslate"><span class="pre">you-complete-me</span></code> 以及vim插件；对于macOS环境通过 <a class="reference internal" href="../../../apple/studio/homebrew.xhtml#homebrew"><span class="std std-ref">Homebrew</span></a> 组合多个工具配置相同环境请参考 <a class="reference internal" href="../../../apple/studio/vim_tmux_iterm_zsh.xhtml#vim-tmux-iterm-zsh"><span class="std std-ref">结合Vim,Tmux,iTerm和Oh-my-Zsh开发环境</span></a> 。</p>
</div>
<section id="id1">
<h2>安装</h2>
<ul>
<li><p>在 <a class="reference internal" href="../../../arm/raspberry_pi/startup/pi_400.xhtml#pi-400"><span class="std std-ref">树莓派Raspberry Pi 400</span></a> 环境，也就是 Debian 10上安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">vim</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id2">
<h2>配置</h2>
<p>几乎不用配置，默认vim提供了基础的语法高亮。不过，你可以定制自己的 <code class="docutils literal notranslate"><span class="pre">.vimrc</span></code> 然后备份，并回复到任何你需要的工作环境中获得一致的体验。</p>
<ul class="simple">
<li><p>初始你可以使用以下简单的 <code class="docutils literal notranslate"><span class="pre">.vimrc</span></code> :</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">install_vim/vimrc_base</span></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s2">&quot; Syntax highlight</span>
<span class="s2">syntax enable</span>

<span class="s2">&quot;</span> Tabs are spaces
<span class="nb">set</span> expandtab
<span class="s2">&quot; Number of spaces per tab</span>
<span class="s2">set tabstop=4</span>

<span class="s2">&quot;</span> Search as soon as characters are entered
<span class="nb">set</span> incsearch
<span class="s2">&quot; Highlight search results</span>
<span class="s2">set hlsearch</span>
</pre></div>
</td></tr></table></div>
</div>
</section>
<section id="id3">
<h2>插件</h2>
<section id="vundle">
<h3>Vundle插件管理器</h3>
<p>要充分发挥vim的强大功能，需要使用插件，可以实现现代IDE的语法高亮，自动补全，目录树视图，debug工具以及很多有用的功能。</p>
<p>推荐使用 Vundle管理插件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">VundleVim</span><span class="o">/</span><span class="n">Vundle</span><span class="o">.</span><span class="n">vim</span><span class="o">.</span><span class="n">git</span> <span class="o">~/.</span><span class="n">vim</span><span class="o">/</span><span class="n">bundle</span><span class="o">/</span><span class="n">Vundle</span><span class="o">.</span><span class="n">vim</span>
</pre></div>
</div>
<p>然后在 <code class="docutils literal notranslate"><span class="pre">.vimrc</span></code> 的开头添加:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">install_vim/vimrc_vundle</span></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="nb">set</span> nocompatible
</span><span class="hll">filetype off
</span><span class="hll">
</span><span class="hll"><span class="nb">set</span> <span class="nv">rtp</span><span class="o">+=</span>~/.vim/bundle/Vundle.vim
</span><span class="hll">call vundle#begin<span class="o">()</span>
</span><span class="hll">
</span><span class="hll">Plugin <span class="s1">&#39;VundleVim/Vundle.vim&#39;</span>
</span><span class="hll">
</span><span class="hll"><span class="s2">&quot; Add your plugins below this line</span>
</span><span class="hll">
</span><span class="hll"><span class="s2">&quot;</span> All of your Plugins must be added before the following line
</span><span class="hll">call vundle#end<span class="o">()</span>
</span><span class="hll">filetype plugin indent on
</span>
<span class="s2">&quot; Syntax highlight</span>
<span class="s2">syntax enable</span>

<span class="s2">&quot;</span> Tabs are spaces
<span class="nb">set</span> expandtab
<span class="s2">&quot; Number of spaces per tab</span>
<span class="s2">set tabstop=4</span>

<span class="s2">&quot;</span> Search as soon as characters are entered
<span class="nb">set</span> incsearch
<span class="s2">&quot; Highlight search results</span>
<span class="s2">set hlsearch</span>
</pre></div>
</td></tr></table></div>
</div>
<p>有关 Vuldle 的详细说明参考 <a class="reference external" href="https://github.com/VundleVim/Vundle.vim">Vundle.vim GitHub</a><span class="link-target"> [https://github.com/VundleVim/Vundle.vim]</span></p>
</section>
<section id="id4">
<h3>安装插件</h3>
<p>安装插件的方法有2步:</p>
<ul class="simple">
<li><p>在 <code class="docutils literal notranslate"><span class="pre">.vimrc</span></code> 中plugin位置处添加插件</p></li>
<li><p>在vim中执行 <code class="docutils literal notranslate"><span class="pre">:PluginInstall</span></code>  命令</p></li>
</ul>
<p>从 <a class="reference external" href="https://vimawesome.com/">VimAwesome网站</a><span class="link-target"> [https://vimawesome.com/]</span> 可以找到GitHub流行的插件列表，以下我们来实践安装 <code class="docutils literal notranslate"><span class="pre">NerdTree</span></code> 插件(文件系统树状浏览视图) 和 <code class="docutils literal notranslate"><span class="pre">YouCompleteMe</span></code> 插件(代码补全)</p>
<ul class="simple">
<li><p>在 <code class="docutils literal notranslate"><span class="pre">.vimrc</span></code> 中添加 <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> 行:</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">install_vim/vimrc_plugins</span></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">set</span> nocompatible
filetype off

<span class="nb">set</span> <span class="nv">rtp</span><span class="o">+=</span>~/.vim/bundle/Vundle.vim
call vundle#begin<span class="o">()</span>

Plugin <span class="s1">&#39;VundleVim/Vundle.vim&#39;</span>

<span class="s2">&quot; Add your plugins below this line</span>

<span class="hll"><span class="s2">Plugin &#39;scrooloose/nerdtree&#39;</span>
</span><span class="hll"><span class="s2">Plugin &#39;valloric/youcompleteme&#39;</span>
</span>
<span class="s2">&quot;</span> All of your Plugins must be added before the following line
call vundle#end<span class="o">()</span>
filetype plugin indent on

<span class="s2">&quot; Syntax highlight</span>
<span class="s2">syntax enable</span>

<span class="s2">&quot;</span> Tabs are spaces
<span class="nb">set</span> expandtab
<span class="s2">&quot; Number of spaces per tab</span>
<span class="s2">set tabstop=4</span>

<span class="s2">&quot;</span> Search as soon as characters are entered
<span class="nb">set</span> incsearch
<span class="s2">&quot; Highlight search results</span>
<span class="s2">set hlsearch</span>
</pre></div>
</td></tr></table></div>
</div>
<ul>
<li><p>然后在vim中执行命令:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:</span><span class="n">PluginInstall</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="youcompleteme">
<h3>YouCompleteMe插件</h3>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>YouCompleteMe 安装是非常繁琐的过程，特别是编译支持golang，需要下载大量依赖模块，而GFW阻塞</p>
</div>
<section id="id5">
<h4>编译vim</h4>
<p>YouCompleteMe插件对vim版本有要求，在树莓派当前Raspberry Pi OS中提供的vim版本不能满足。可以参考 <a class="reference external" href="https://github.com/ycm-core/YouCompleteMe/wiki/Building-Vim-from-source">Building Vim from source</a><span class="link-target"> [https://github.com/ycm-core/YouCompleteMe/wiki/Building-Vim-from-source]</span> 进行编译安装</p>
<ul>
<li><p>首先安装依赖:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libncurses5</span><span class="o">-</span><span class="n">dev</span> <span class="n">libgtk2</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">dev</span> <span class="n">libatk1</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">dev</span> \
<span class="n">libcairo2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libx11</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxpm</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxt</span><span class="o">-</span><span class="n">dev</span> <span class="n">python2</span><span class="o">-</span><span class="n">dev</span> \
<span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">ruby</span><span class="o">-</span><span class="n">dev</span> <span class="n">lua5</span><span class="o">.</span><span class="mi">2</span> <span class="n">liblua5</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libperl</span><span class="o">-</span><span class="n">dev</span> <span class="n">git</span>
</pre></div>
</div>
</li>
</ul>
<p>我不编译gvim，则不安装图形相关开发库，另外根据自己需要编写的语言安装开发库，可以取消部分不安装，例如，如果不编写perl，可以不安装 <code class="docutils literal notranslate"><span class="pre">libperl-dev</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libncurses5</span><span class="o">-</span><span class="n">dev</span> <span class="n">python2</span><span class="o">-</span><span class="n">dev</span> \
<span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">ruby</span><span class="o">-</span><span class="n">dev</span> <span class="n">lua5</span><span class="o">.</span><span class="mi">3</span> <span class="n">liblua5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">dev</span> <span class="n">git</span>
</pre></div>
</div>
<ul>
<li><p>删除已经安装的vim:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">remove</span> <span class="n">vim</span> <span class="n">vim</span><span class="o">-</span><span class="n">runtime</span> <span class="n">gvim</span>
</pre></div>
</div>
</li>
<li><p>编译 Vim</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/vim/vim.git
cd vim
./configure --with-features=huge \
            --enable-multibyte \
            --enable-rubyinterp=yes \
            --enable-python3interp=yes \
            --with-python3-config-dir=$(python3-config --configdir) \
            --enable-perlinterp=yes \
            --enable-luainterp=yes \
            --enable-gui=gtk2 \
            --enable-cscope \
            --prefix=/usr/local
</pre></div>
</div>
</li>
</ul>
<p>我的编译选项做了精简如下:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./configure --with-features=huge \
            --enable-multibyte \
            --enable-rubyinterp=yes \
            --enable-python3interp=yes \
            --with-python3-config-dir=$(python3-config --configdir) \
            --enable-luainterp=yes \
            --enable-cscope \
            --prefix=/usr/local
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>对于Ubuntu用户，只能使用Python 2或Python 3，所以不能同时使用 <code class="docutils literal notranslate"><span class="pre">python-config-dir</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python3-config-dir</span></code> ，否则 YouCompleteMe 会在启动vim时提示 <code class="docutils literal notranslate"><span class="pre">YouCompleteMe</span> <span class="pre">unavailable:</span> <span class="pre">requires</span> <span class="pre">Vim</span> <span class="pre">compiled</span> <span class="pre">with</span> <span class="pre">Python</span> <span class="pre">(2.6+</span> <span class="pre">or</span> <span class="pre">3.3+)</span> <span class="pre">support</span></code> 。</p>
</div>
<ul>
<li><p>编译:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">VIMRUNTIMEDIR</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vim</span><span class="o">/</span><span class="n">vim82</span>
</pre></div>
</div>
</li>
<li><p>为了方便卸载，先安装 <a class="reference external" href="https://wiki.debian.org/CheckInstall">checkinstall</a><span class="link-target"> [https://wiki.debian.org/CheckInstall]</span> 再进行安装(会按照系统包管理器生成包进行安装，这样就方便卸载):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">checkinstall</span>
<span class="n">sudo</span> <span class="n">checkinstall</span>
</pre></div>
</div>
</li>
<li><p>也可以直接安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
</li>
<li><p>设置vim作为默认编辑器:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="n">install</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">editor</span> <span class="n">editor</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vim</span> <span class="mi">1</span>
<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="nb">set</span> <span class="n">editor</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vim</span>
<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="n">install</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vi</span> <span class="n">vi</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vim</span> <span class="mi">1</span>
<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="nb">set</span> <span class="n">vi</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vim</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="id6">
<h3>安装其他插件</h3>
<p>为了开发golang，另外安装 <a class="reference external" href="https://github.com/fatih/vim-go">vim-go插件</a><span class="link-target"> [https://github.com/fatih/vim-go]</span> 和 <a class="reference external" href="https://github.com/preservim/tagbar">Tagbar插件</a><span class="link-target"> [https://github.com/preservim/tagbar]</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Plugin</span> <span class="s1">&#39;fatih/vim-go&#39;</span>
<span class="n">Plugin</span> <span class="s1">&#39;Tagbar&#39;</span>
</pre></div>
</div>
<p>其中  <code class="docutils literal notranslate"><span class="pre">Tagbar</span></code> 需要 <code class="docutils literal notranslate"><span class="pre">ctags/gotags</span></code> 支持，依赖 <code class="docutils literal notranslate"><span class="pre">Exuberant</span> <span class="pre">Ctags</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Universal</span> <span class="pre">Ctags</span></code> ，安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">exuberant</span><span class="o">-</span><span class="n">ctags</span> <span class="n">universal</span><span class="o">-</span><span class="n">ctags</span>
<span class="n">go</span> <span class="n">get</span> <span class="o">-</span><span class="n">u</span> <span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jstemmer</span><span class="o">/</span><span class="n">gotags</span>
</pre></div>
</div>
</section>
<section id="golang-vimrc">
<h3>配置golang的.vimrc</h3>
<ul class="simple">
<li><p>配置 <code class="docutils literal notranslate"><span class="pre">vim-go</span></code> , <code class="docutils literal notranslate"><span class="pre">Tagbar</span></code> 和 <code class="docutils literal notranslate"><span class="pre">NERDTree</span></code></p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">install_vim/vimrc_golang</span></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">set</span> nocompatible
filetype off

<span class="nb">set</span> <span class="nv">rtp</span><span class="o">+=</span>~/.vim/bundle/Vundle.vim
call vundle#begin<span class="o">()</span>

Plugin <span class="s1">&#39;VundleVim/Vundle.vim&#39;</span>

<span class="s2">&quot; Add your plugins below this line</span>
<span class="s2">Plugin &#39;fatih/vim-go&#39;</span>
<span class="s2">Plugin &#39;scrooloose/nerdtree&#39;</span>
<span class="s2">Plugin &#39;valloric/youcompleteme&#39;</span>
<span class="s2">Plugin &#39;Tagbar&#39;</span>
<span class="s2">&quot;</span> All of your Plugins must be added before the following line
call vundle#end<span class="o">()</span>
filetype plugin indent on

<span class="s2">&quot; YCM need utf-8</span>
<span class="s2">set encoding=utf-8</span>

<span class="s2">&quot;</span> Syntax highlight
syntax <span class="nb">enable</span>

<span class="s2">&quot; Tabs are spaces</span>
<span class="s2">set expandtab</span>
<span class="s2">&quot;</span> Number of spaces per tab
<span class="nb">set</span> <span class="nv">tabstop</span><span class="o">=</span><span class="m">4</span>

<span class="s2">&quot; Search as soon as characters are entered</span>
<span class="s2">set incsearch</span>
<span class="s2">&quot;</span> Highlight search results
<span class="nb">set</span> hlsearch

<span class="hll"><span class="s2">&quot; vim-go  golang</span>
</span><span class="hll"><span class="s2">let g:go_autodetect_gopath = 1</span>
</span><span class="hll"><span class="s2">let g:go_list_type = &quot;</span>quickfix<span class="s2">&quot;</span>
</span><span class="hll"><span class="s2">let g:go_version_warning = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_types = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_fields = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_functions = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_function_calls = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_operators = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_extra_types = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_methods = 1</span>
</span><span class="hll"><span class="s2">let g:go_highlight_generate_tags = 1</span>
</span><span class="hll"><span class="s2">let g:godef_split=2</span>
</span><span class="hll">
</span><span class="hll"><span class="s2">&quot;</span> NERDTree
</span><span class="hll">
</span><span class="hll"><span class="s2">&quot; 打开和关闭NERDTree快捷键</span>
</span><span class="hll"><span class="s2">map &lt;F10&gt; :NERDTreeToggle&lt;CR&gt;</span>
</span><span class="hll"><span class="s2">&quot;</span> 设置宽度
</span><span class="hll"><span class="nb">let</span> <span class="nv">NERDTreeWinSize</span><span class="o">=</span><span class="m">25</span>
</span><span class="hll">
</span><span class="hll"><span class="s2">&quot; Tagbar</span>
</span><span class="hll"><span class="s2">nmap &lt;F9&gt; :TagbarToggle&lt;CR&gt;</span>
</span><span class="hll"><span class="s2">let g:tagbar_width=25</span>
</span><span class="hll"><span class="s2">let g:tagbar_type_go = {</span>
</span><span class="hll"><span class="s2">    \ &#39;ctagstype&#39; : &#39;go&#39;,</span>
</span><span class="hll"><span class="s2">    \ &#39;kinds&#39;     : [</span>
</span><span class="hll"><span class="s2">        \ &#39;p:package&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;i:imports:1&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;c:constants&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;v:variables&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;t:types&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;n:interfaces&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;w:fields&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;e:embedded&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;m:methods&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;r:constructor&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;f:functions&#39;</span>
</span><span class="hll"><span class="s2">    \ ],</span>
</span><span class="hll"><span class="s2">    \ &#39;sro&#39; : &#39;.&#39;,</span>
</span><span class="hll"><span class="s2">    \ &#39;kind2scope&#39; : {</span>
</span><span class="hll"><span class="s2">        \ &#39;t&#39; : &#39;ctype&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;n&#39; : &#39;ntype&#39;</span>
</span><span class="hll"><span class="s2">    \ },</span>
</span><span class="hll"><span class="s2">    \ &#39;scope2kind&#39; : {</span>
</span><span class="hll"><span class="s2">        \ &#39;ctype&#39; : &#39;t&#39;,</span>
</span><span class="hll"><span class="s2">        \ &#39;ntype&#39; : &#39;n&#39;</span>
</span><span class="hll"><span class="s2">    \ },</span>
</span><span class="hll"><span class="s2">    \ &#39;ctagsbin&#39;  : &#39;gotags&#39;,</span>
</span><span class="hll"><span class="s2">    \ &#39;ctagsargs&#39; : &#39;-sort -silent&#39;</span>
</span><span class="hll"><span class="s2">    \ }</span>
</span></pre></div>
</td></tr></table></div>
</div>
<section id="id7">
<h4>编译安装YouCompleteMe</h4>
<p>在编译YouCompleteMe之前，首先需要把你需要支持的语言开发工具安装好，然后才能在编译安装YouCompleteMe时候开启参数。</p>
<ul>
<li><p>安装语言工具:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">golang</span> <span class="n">nodejs</span> <span class="n">default</span><span class="o">-</span><span class="n">jdk</span> <span class="n">npm</span>
</pre></div>
</div>
</li>
</ul>
<p>如果需要开发 c# ，还需要安装 <code class="docutils literal notranslate"><span class="pre">mono-complete</span></code></p>
<ul>
<li><p>安装YCM编译工具:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">cmake</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
</li>
<li><p>编译YCM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/.</span><span class="n">vim</span><span class="o">/</span><span class="n">bundle</span><span class="o">/</span><span class="n">youcompleteme</span>
<span class="n">python3</span> <span class="n">install</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="nb">all</span>
</pre></div>
</div>
</li>
</ul>
<p>这里可以不使用 <code class="docutils literal notranslate"><span class="pre">--all</span></code> 参数，而单独指定需要支持的语言：</p>
<blockquote>
<div><ul class="simple">
<li><p>需要支持 C一族语言使用 <code class="docutils literal notranslate"><span class="pre">--clangd-completer</span></code></p></li>
<li><p>支持C# 则安装mono 然后使用 <code class="docutils literal notranslate"><span class="pre">--cs-completer</span></code></p></li>
<li><p>支持Go 则安装Go然后使用 <code class="docutils literal notranslate"><span class="pre">--go-completer</span></code></p></li>
<li><p>支持JavaScript和TypeScript 则安装 node.js 和 npm ，然后使用 <code class="docutils literal notranslate"><span class="pre">--ts-completer</span></code></p></li>
<li><p>支持Rust 则使用 <code class="docutils literal notranslate"><span class="pre">--rust-completer</span></code></p></li>
<li><p>支持Java 则安装JDK 8 然后使用 <code class="docutils literal notranslate"><span class="pre">--java-completer</span></code></p></li>
</ul>
</div></blockquote>
<p>如果不指定任何参数，则编译的YCM仅支持Python代码补全。</p>
<p>我使用如下编译方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">install</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">clangd</span><span class="o">-</span><span class="n">completer</span> <span class="o">--</span><span class="n">go</span><span class="o">-</span><span class="n">completer</span> \
    <span class="o">--</span><span class="n">ts</span><span class="o">-</span><span class="n">completer</span> <span class="o">--</span><span class="n">rust</span><span class="o">-</span><span class="n">completer</span> <span class="o">--</span><span class="n">java</span><span class="o">-</span><span class="n">completer</span>
</pre></div>
</div>
<p>遇到报错:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">reading</span> <span class="n">manifest</span> <span class="n">file</span> <span class="s1">&#39;src/watchdog.egg-info/SOURCES.txt&#39;</span>
<span class="n">reading</span> <span class="n">manifest</span> <span class="n">template</span> <span class="s1">&#39;MANIFEST.in&#39;</span>
<span class="n">warning</span><span class="p">:</span> <span class="n">no</span> <span class="n">files</span> <span class="n">found</span> <span class="n">matching</span> <span class="s1">&#39;*.h&#39;</span> <span class="n">under</span> <span class="n">directory</span> <span class="s1">&#39;src&#39;</span>
<span class="n">writing</span> <span class="n">manifest</span> <span class="n">file</span> <span class="s1">&#39;src/watchdog.egg-info/SOURCES.txt&#39;</span>
<span class="n">go</span><span class="p">:</span> <span class="n">finding</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span><span class="o">/</span><span class="n">v2</span> <span class="n">v2</span><span class="o">.</span><span class="mf">2.0</span>
<span class="n">go</span><span class="p">:</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span><span class="o">/</span><span class="n">v2</span><span class="nd">@v2</span><span class="o">.</span><span class="mf">2.0</span><span class="p">:</span> <span class="n">unknown</span> <span class="n">revision</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span><span class="o">/</span><span class="n">v2</span><span class="o">.</span><span class="mf">2.0</span>
<span class="n">go</span><span class="p">:</span> <span class="n">error</span> <span class="n">loading</span> <span class="n">module</span> <span class="n">requirements</span>
</pre></div>
</div>
<p><a class="reference external" href="https://pkg.go.dev/mvdan.cc/xurls/v2">xurls</a><span class="link-target"> [https://pkg.go.dev/mvdan.cc/xurls/v2]</span> 是使用正则表达式解析url的工具，在Go 1.13开始使用。上述报错可以参考 <a class="reference external" href="https://stackoverflow.com/questions/58253972/getting-go-error-loading-module-requirements">Getting: go: error loading module requirements</a><span class="link-target"> [https://stackoverflow.com/questions/58253972/getting-go-error-loading-module-requirements]</span> ，主要是go模块下载问题，手工单独安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">go</span> <span class="n">get</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span><span class="o">/</span><span class="n">v2</span><span class="nd">@v2</span><span class="o">.</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>提示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">go</span><span class="p">:</span> <span class="n">finding</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span><span class="o">/</span><span class="n">v2</span> <span class="n">v2</span><span class="o">.</span><span class="mf">2.0</span>
<span class="n">go</span><span class="p">:</span> <span class="n">downloading</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span> <span class="n">v0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">-</span><span class="mi">20200417124523</span><span class="o">-</span><span class="mi">1707</span><span class="n">d8b9d1bb</span>
<span class="n">go</span> <span class="n">get</span> <span class="n">mvdan</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">xurls</span><span class="o">/</span><span class="n">v2</span><span class="nd">@v2</span><span class="o">.</span><span class="mf">2.0</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">mod</span> <span class="n">has</span> <span class="n">post</span><span class="o">-</span><span class="n">v0</span> <span class="n">module</span> <span class="n">path</span> <span class="s2">&quot;mvdan.cc/xurls/v2&quot;</span> <span class="n">at</span> <span class="n">revision</span> <span class="mi">1707</span><span class="n">d8b9d1bb</span>
</pre></div>
</div>
<p>但是我发现当前 <a class="reference internal" href="../../../arm/raspberry_pi/startup/pi_400.xhtml#pi-400"><span class="std std-ref">树莓派Raspberry Pi 400</span></a> 的Raspberry Pi OS提供的golang版本是 <code class="docutils literal notranslate"><span class="pre">1.11</span></code> ，可能低于 <code class="docutils literal notranslate"><span class="pre">xurls</span></code> 版本  <code class="docutils literal notranslate"><span class="pre">1.13</span></code>  要求，使用以下命令检查仓库提供的golang版本:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">cache</span> <span class="n">search</span> <span class="n">golang</span><span class="o">|</span><span class="n">grep</span> <span class="n">golang</span><span class="o">-</span><span class="mf">1.</span><span class="o">*</span>
</pre></div>
</div>
<p>可以看到软件仓库提供的最高版本只有 1.12 ，不能满足要求。</p>
<p>卸载Raspberry Pi OS tigong</p>
</section>
</section>
<section id="id8">
<h3>使用YouCompleteMe</h3>
<p>当输入时，YCM会自动提示最接近的可选输入内容，可以持续输入直到真正匹配内容高亮，此时按下 <code class="docutils literal notranslate"><span class="pre">tab</span></code> 键自动完成输入:</p>
<figure class="align-default">
<img alt="../../../_images/ycm.gif" src="../../../_images/ycm.gif" />
</figure>
</section>
</section>
<section id="id9">
<h2>参考</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://roboticsbackend.com/install-use-vim-raspberry-pi/">Install and Use Vim on Raspberry Pi</a><span class="link-target"> [https://roboticsbackend.com/install-use-vim-raspberry-pi/]</span></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/Wind4study/article/details/104565482">CentOS 8 搭建Vim golang环境 &amp;&amp; YouCompleteMe Golang安装支持</a><span class="link-target"> [https://blog.csdn.net/Wind4study/article/details/104565482]</span></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/liangsir_l/article/details/50608350">配置vim,打造自己的C IDE</a><span class="link-target"> [https://blog.csdn.net/liangsir_l/article/details/50608350]</span> - 这篇文档还没有实践，待完善</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>