<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Arch Linux运行snap</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="arch-linuxsnap">
<span id="archlinux-snap"></span><h1>Arch Linux运行snap</h1>
<p>正如 <a class="reference internal" href="../../appendix/anbox_scratch.xhtml#anbox-scratch"><span class="std std-ref">探索Anbox运行Andorid程序</span></a> 提到的，在snap容器运行环境中，可以运行很多有趣的应用，例如微信。在Arch Linux下也能够安装运行snap运行环境，这样可以方便使用很多桌面软件。</p>
<section id="snap">
<h2>安装snap环境</h2>
<ul>
<li><p>安装snapd:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yay</span> <span class="o">-</span><span class="n">S</span> <span class="n">snapd</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p><code class="docutils literal notranslate"><span class="pre">snapd</span></code> 安装了一个脚本在 <code class="docutils literal notranslate"><span class="pre">/etc/profile.d/snapd.sh</span></code> 来输出所有安装的snapd包和桌面入口的路径，所以要重启一次系统才能生效。</p>
</div>
<p>启用snapd:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">snapd</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">snapd</span>
</pre></div>
</div>
<ul>
<li><p>(可选)激活apparmor可以将snap程序运行在受限制的沙箱内，提供更好的安全性(如果不使用AppArmor就会让所有snaps运行在 <code class="docutils literal notranslate"><span class="pre">devel</span></code> 模式，也就是没有限制地访问系统，就好像普通应用程序):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">apparmor</span><span class="o">.</span><span class="n">service</span>
<span class="n">systemctl</span> <span class="n">enable</span> <span class="o">--</span><span class="n">now</span> <span class="n">snapd</span><span class="o">.</span><span class="n">apparmor</span><span class="o">.</span><span class="n">service</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id1">
<h2>使用snap</h2>
<ul>
<li><p>查找可用的snap:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">snap</span> <span class="n">find</span> <span class="n">searchterm</span>
</pre></div>
</div>
</li>
<li><p>安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">snap</span> <span class="n">install</span> <span class="n">snapname</span>
</pre></div>
</div>
</li>
</ul>
<p>注意安装需要root权限。会创建每个snap的挂载但愿，并将其加入到 <code class="docutils literal notranslate"><span class="pre">/etc/systemd/system/multi-user.target.wants/</span></code> 作为软连接，以便系统启动时所有snaps就绪。</p>
<ul>
<li><p>显示已经安装的snap:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">snap</span> <span class="nb">list</span>
</pre></div>
</div>
</li>
<li><p>更新:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">snap</span> <span class="n">refresh</span>
</pre></div>
</div>
</li>
<li><p>删除:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">snap</span> <span class="n">remove</span> <span class="n">snapname</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>一些snap，例如 Skype 和 Pycharm 使用经典配置，需要 <code class="docutils literal notranslate"><span class="pre">/snap</span></code> 目录，不是 FHS兼容，则需要手工创建:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">snapd</span><span class="o">/</span><span class="n">snap</span> <span class="o">/</span><span class="n">snap</span>
</pre></div>
</div>
</div>
</section>
<section id="id2">
<h2>安装微信</h2>
<ul>
<li><p>安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">snap</span> <span class="n">install</span> <span class="n">electronic</span><span class="o">-</span><span class="n">wechat</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>