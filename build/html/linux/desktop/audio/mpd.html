<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MPD(Music Player Daemon) &mdash; Cloud Atlas 0.1 文档</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/translations.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" />
    <link rel="copyright" title="版权所有" href="../../../copyright.html" />
    <link rel="next" title="修正xorg显示dpi" href="../xorg_dpi_fix.html" />
    <link rel="prev" title="在Linux环境播放音乐" href="play_music_on_linux.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Cloud Atlas
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../studio/index.html">Studio Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infrastructure/index.html">Infrastructure Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops/index.html">DevOps Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kvm/index.html">KVM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ceph/index.html">Ceph Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gluster/index.html">Gluster Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ovirt/index.html">oVirt Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openstack/index.html">OpenStack Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docker/index.html">Docker Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kubernetes/index.html">Kubernetes Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kubernetes_from_scratch/index.html">Kubernetes From Scratch (KFS) Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rancher/index.html">Rancher Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openshift/index.html">OpenShift Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sql/index.html">SQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sqlite/index.html">SQLite Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mysql/index.html">MySQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pgsql/index.html">PostgreSQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nosql/index.html">NoSQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../redis/index.html">Redis Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../network/index.html">Network Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infra_service/index.html">Infra-Service Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infra_search/index.html">Search Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../info_service/index.html">Info-Service Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../web/index.html">Web Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../big_data/index.html">Big Data Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../machine_learning/index.html">Machine Learning Atlas</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Linux Atlas</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../best_linux.html">最佳Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../admin/index.html">Linux系统管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redhat_linux/index.html">RedHat Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arch_linux/index.html">Arch Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../asahi_linux/index.html">Asahi Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gentoo_linux/index.html">Gentoo Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lfs_linux/index.html">LFS(Linux from scratch)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ubuntu_linux/index.html">Ubuntu Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../suse_linux/index.html">SUSE Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kali_linux/index.html">Kali Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tails_linux/index.html">Tails Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../postmarketos/index.html">postmarketOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../container_os/index.html">容器化操作系统(Container OS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fedora_coreos/index.html">Fedora CoreOS容器操作系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chromium_os/index.html">Chromium OS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../alpine_linux/index.html">Alpine Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subgraph_os/index.html">Subgraph OS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kaios/index.html">KaiOS - 世界第三手机操作系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../compute/index.html">Linux计算</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/index.html">Linux存储</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../network/index.html">Linux网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../server/index.html">Linux服务器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/index.html">Linux安全</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Linux桌面</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../x_window/index.html">X Window显示服务器协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chinese/index.html">Linux中文环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rdp/index.html">Linux桌面</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wayland/index.html">wayland显示服务器协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sway/index.html">sway - i3兼容Wayland compositor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../suckless/index.html">Suckless极简桌面</a></li>
<li class="toctree-l3"><a class="reference internal" href="../xfce/index.html">xfce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lxqt/index.html">LXQt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kde/index.html">KDE桌面</a></li>
<li class="toctree-l3"><a class="reference internal" href="../xpra/index.html">X持久化远程应用Xpra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vim/index.html">Vim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vscode/index.html">VS Code</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Linux音频</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="alsa.html">ALSA内核声音子系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulseaudio.html">PulseAudio</a></li>
<li class="toctree-l4"><a class="reference internal" href="play_music_on_linux.html">在Linux环境播放音乐</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">MPD(Music Player Daemon)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../xorg_dpi_fix.html">修正xorg显示dpi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i3.html">i3窗口管理器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oh_my_zsh.html">Oh My Zsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tmux.html">tmux多会话终端管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alacritty.html">GPU加速终端模拟器alacritty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../read_ebook_in_linux.html">在Linux环境阅读电子书</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mupdf.html">MuPDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../remote_linux_desktop.html">远程访问Linux桌面</a></li>
<li class="toctree-l3"><a class="reference internal" href="../light_browser.html">Linux轻量级浏览器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netsurf.html">NetSurf轻量级浏览器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synergy.html">Synergy:主机间共享键盘鼠标</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hidclient.html">Linux主机转换成蓝牙键盘鼠标hdiclient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../terminal_emulator.html">Linux终端模拟器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../uxvrt_ch_font.html">uxvrt中文字体设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../keepassxc.html">KeepassXC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../linux_tablet/index.html">Linux平板</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../kernel/index.html">Kernel Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance/index.html">Performance Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributed_system/index.html">Distributed System Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../shell/index.html">Shell Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/index.html">Python Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../django/index.html">Django Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../javascript/index.html">JavaScript Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nodejs/index.html">Node.js Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../golang/index.html">Go Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../swift/index.html">Swift Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rust/index.html">Rust Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../arm/index.html">ARM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../android/index.html">Android Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bsd/index.html">BSD Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apple/index.html">Apple Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../windows/index.html">Windows Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../real/index.html">Real Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../management/index.html">Management Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../life/index.html">Life Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutme.html">关于作者</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../donate.html">捐赠</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../thanks.html">感谢</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendix/index.html">附录</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Cloud Atlas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Linux Atlas</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Linux桌面</a></li>
          <li class="breadcrumb-item"><a href="index.html">Linux音频</a></li>
      <li class="breadcrumb-item active">MPD(Music Player Daemon)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/linux/desktop/audio/mpd.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mpd-music-player-daemon">
<span id="mpd"></span><h1>MPD(Music Player Daemon)<a class="headerlink" href="#mpd-music-player-daemon" title="此标题的永久链接">¶</a></h1>
<p>MPD(Music Player Daemon)是一个客户服务器架构的音频播放器，用于播放音频文件，管理播放列表以及维护一个音乐数据库。这些功能都使用非常少的资源，而且可以使用不同的独立客户端。</p>
<section id="id1">
<h2>安装<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<ul>
<li><p>在 <a class="reference internal" href="../../ubuntu_linux/index.html#ubuntu-linux"><span class="std std-ref">Ubuntu Linux</span></a> 上安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">mpd</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id2">
<h2>配置<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h2>
<p>MPD可以运行在 <code class="docutils literal notranslate"><span class="pre">按用户配置</span></code> 和 <code class="docutils literal notranslate"><span class="pre">系统范围配置</span></code> (配置针对所有用户)两种模式，也可以在一个主机上运行多个MPD实例。最简单的设置方法是本地 <code class="docutils literal notranslate"><span class="pre">按用户配置</span></code> ，比较适合桌面系统。而 <code class="docutils literal notranslate"><span class="pre">系统范围配置</span></code> 则较为适合音频服务器，可以多个用户共享一个MPD实例。</p>
<p>要让MPD能够播放音频，需要设置 <a class="reference internal" href="alsa.html#alsa"><span class="std std-ref">ALSA内核声音子系统</span></a> 或者 <a class="reference internal" href="pulseaudio.html#pulseaudio"><span class="std std-ref">PulseAudio</span></a> 或 <code class="docutils literal notranslate"><span class="pre">PipeWire</span></code></p>
<p>MPD通过 <code class="docutils literal notranslate"><span class="pre">mpd.conf</span></code> 配置，该配置可以按用户模式和系统模式:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">~/.config/mpd/mpd.conf</span></code> 是每个用户配置</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/mpd.conf</span></code> 系统范围配置</p></li>
</ul>
<p>常用配置:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pid_file</span></code> : 存放MPD进程ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db_file</span></code> : 音乐数据库</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state_file</span></code> : MPD当前状态</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">playlist_directory</span></code> : 保存播放列表的目录</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">music_directory</span></code> : MPD扫描音乐的目录</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sticker_file</span></code> : 便签数据库，存储音乐相关信息</p></li>
</ul>
<section id="id3">
<h3>每个用户的独立配置<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h3>
<ul>
<li><p>复制配置文件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">~/.</span><span class="n">config</span><span class="o">/</span><span class="n">mpd</span>
<span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">mpd</span><span class="o">/</span><span class="n">mpdconf</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">gz</span> <span class="o">~/.</span><span class="n">config</span><span class="o">/</span><span class="n">mpd</span><span class="o">/</span>
<span class="n">cd</span> <span class="o">~/.</span><span class="n">config</span><span class="o">/</span><span class="n">mpd</span>
<span class="n">gzip</span> <span class="o">-</span><span class="n">d</span> <span class="n">mpdconf</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">gz</span>
<span class="n">mv</span> <span class="n">mpdconf</span><span class="o">.</span><span class="n">example</span> <span class="n">mpd</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
<li><p>修订 <code class="docutils literal notranslate"><span class="pre">~/.config/mpd/mpd.conf</span></code> :</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">~/.config/mpd/mpd.conf 配置案例</span><a class="headerlink" href="#id7" title="此代码块的永久链接">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 数据库</span>
db_file         <span class="s2">&quot;~/.config/mpd/database&quot;</span>

<span class="c1"># 日志</span>
log_file            <span class="s2">&quot;~/.config/mpd/log&quot;</span>

<span class="c1"># 音乐目录</span>
music_directory        <span class="s2">&quot;~/Music&quot;</span>

<span class="c1"># Uncomment to refresh the database whenever files in the music_directory are changed</span>
auto_update <span class="s2">&quot;yes&quot;</span>

<span class="c1"># Uncomment to enable the functionalities</span>
playlist_directory <span class="s2">&quot;~/.config/mpd/playlists&quot;</span>
pid_file           <span class="s2">&quot;~/.config/mpd/pid&quot;</span>
state_file         <span class="s2">&quot;~/.config/mpd/state&quot;</span>
sticker_file       <span class="s2">&quot;~/.config/mpd/sticker.sql&quot;</span>

<span class="c1"># Raspberry Pi OS 只需要配置 alsa 类型设备，无需详细配置</span>
audio_output <span class="o">{</span>
        <span class="nb">type</span>          <span class="s2">&quot;alsa&quot;</span>
        name          <span class="s2">&quot;ALSA sound card&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>根据配置需要创建一个playlists子目录:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">~/.</span><span class="n">config</span><span class="o">/</span><span class="n">mpd</span><span class="o">/</span><span class="n">playlists</span>
</pre></div>
</div>
<ul>
<li><p>启动 <code class="docutils literal notranslate"><span class="pre">mpd</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpd</span> <span class="o">~/.</span><span class="n">config</span><span class="o">/</span><span class="n">mpd</span><span class="o">/</span><span class="n">mpd</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
</ul>
<p>提示信息:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Apr</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">:</span><span class="mi">09</span> <span class="p">:</span> <span class="n">server_socket</span><span class="p">:</span> <span class="n">bind</span> <span class="n">to</span> <span class="s1">&#39;0.0.0.0:6600&#39;</span> <span class="n">failed</span> <span class="p">(</span><span class="n">continuing</span> <span class="n">anyway</span><span class="p">,</span> <span class="n">because</span> <span class="n">binding</span> <span class="n">to</span> <span class="s1">&#39;[::]:6600&#39;</span> <span class="n">succeeded</span><span class="p">):</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">bind</span> <span class="n">socket</span><span class="p">:</span> <span class="n">Address</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">use</span>
<span class="n">Apr</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">:</span><span class="mi">09</span> <span class="p">:</span> <span class="n">decoder</span><span class="p">:</span> <span class="n">Decoder</span> <span class="n">plugin</span> <span class="s1">&#39;wildmidi&#39;</span> <span class="ow">is</span> <span class="n">unavailable</span><span class="p">:</span> <span class="n">configuration</span> <span class="n">file</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">timidity</span><span class="o">/</span><span class="n">timidity</span><span class="o">.</span><span class="n">cfg</span>
<span class="n">Apr</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">:</span><span class="mi">09</span> <span class="p">:</span> <span class="n">exception</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="nb">open</span> <span class="s1">&#39;/home/huatai/.config/mpd/database&#39;</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
<span class="n">Apr</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">:</span><span class="mi">09</span> <span class="p">:</span> <span class="n">output</span><span class="p">:</span> <span class="n">No</span> <span class="s1">&#39;audio_output&#39;</span> <span class="n">defined</span> <span class="ow">in</span> <span class="n">config</span> <span class="n">file</span>
<span class="n">Apr</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">:</span><span class="mi">09</span> <span class="p">:</span> <span class="n">output</span><span class="p">:</span> <span class="n">Successfully</span> <span class="n">detected</span> <span class="n">a</span> <span class="n">sndio</span> <span class="n">audio</span> <span class="n">device</span>
</pre></div>
</div>
<ul>
<li><p>检查服务:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">mpd</span>
</pre></div>
</div>
</li>
</ul>
<p>可看到:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>huatai    139542  1.3  1.1 444124 44992 ?        Ssl  15:09   0:01 mpd /home/huatai/.config/mpd/mpd.conf
</pre></div>
</div>
<ul>
<li><p>检查端口:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lsof</span> <span class="o">|</span> <span class="n">grep</span> <span class="mi">6600</span>
</pre></div>
</div>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">mpd</span>       <span class="mi">139542</span>                            <span class="n">huatai</span>   <span class="mi">11</span><span class="n">u</span>     <span class="n">IPv6</span>             <span class="mi">615750</span>       <span class="mi">0</span><span class="n">t0</span>        <span class="n">TCP</span> <span class="o">*</span><span class="p">:</span><span class="mi">6600</span> <span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
<span class="n">mpd</span>       <span class="mi">139542</span> <span class="mi">139544</span> <span class="n">io</span>                  <span class="n">huatai</span>   <span class="mi">11</span><span class="n">u</span>     <span class="n">IPv6</span>             <span class="mi">615750</span>       <span class="mi">0</span><span class="n">t0</span>        <span class="n">TCP</span> <span class="o">*</span><span class="p">:</span><span class="mi">6600</span> <span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
<span class="n">mpd</span>       <span class="mi">139542</span> <span class="mi">139545</span> <span class="n">rtio</span>                <span class="n">huatai</span>   <span class="mi">11</span><span class="n">u</span>     <span class="n">IPv6</span>             <span class="mi">615750</span>       <span class="mi">0</span><span class="n">t0</span>        <span class="n">TCP</span> <span class="o">*</span><span class="p">:</span><span class="mi">6600</span> <span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p>如果没有设置 <code class="docutils literal notranslate"><span class="pre">auto_update=yes</span></code> 则可以使用 <code class="docutils literal notranslate"><span class="pre">mpc</span></code> 客户端更新数据库:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpc</span> <span class="n">update</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id4">
<h3>音频配置<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h3>
<p>如果使用了 <a class="reference internal" href="alsa.html#alsa"><span class="std std-ref">ALSA内核声音子系统</span></a> 在默认设备使用 <code class="docutils literal notranslate"><span class="pre">autodection</span></code> 就可以工作，无需任何配置。 <strong>确实如此</strong></p>
<p>不过我在 <a class="reference internal" href="../../../arm/raspberry_pi/hardware/pi_400.html#pi-400"><span class="std std-ref">树莓派Raspberry Pi 400</span></a> 上使用HDMI输出，需要明确配置ALSA音频输出定义才能工作： 精确的设备定义可以通过 <code class="docutils literal notranslate"><span class="pre">aplay</span> <span class="pre">--list-pcm</span></code> 获得</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Kali Linux 上 aplay –list-pcm 输出信息</span><a class="headerlink" href="#id8" title="此代码块的永久链接">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>null
    Discard all samples <span class="o">(</span>playback<span class="o">)</span> or generate zero samples <span class="o">(</span>capture<span class="o">)</span>
default
    Playback/recording through the PulseAudio sound server
lavrate
    Rate Converter Plugin Using Libav/FFmpeg Library
samplerate
    Rate Converter Plugin Using Samplerate Library
speexrate
    Rate Converter Plugin Using Speex Resampler
jack
    JACK Audio Connection Kit
oss
    Open Sound System
pulse
    PulseAudio Sound Server
upmix
    Plugin <span class="k">for</span> channel upmix <span class="o">(</span><span class="m">4</span>,6,8<span class="o">)</span>
vdownmix
    Plugin <span class="k">for</span> channel downmix <span class="o">(</span>stereo<span class="o">)</span> with a simple spacialization
hw:CARD<span class="o">=</span>b1,DEV<span class="o">=</span><span class="m">0</span>
    bcm2835 HDMI <span class="m">1</span>, bcm2835 HDMI <span class="m">1</span>
    Direct hardware device without any conversions
plughw:CARD<span class="o">=</span>b1,DEV<span class="o">=</span><span class="m">0</span>
    bcm2835 HDMI <span class="m">1</span>, bcm2835 HDMI <span class="m">1</span>
    Hardware device with all software conversions
sysdefault:CARD<span class="o">=</span>b1
    bcm2835 HDMI <span class="m">1</span>, bcm2835 HDMI <span class="m">1</span>
    Default Audio Device
dmix:CARD<span class="o">=</span>b1,DEV<span class="o">=</span><span class="m">0</span>
    bcm2835 HDMI <span class="m">1</span>, bcm2835 HDMI <span class="m">1</span>
    Direct sample mixing device
usbstream:CARD<span class="o">=</span>b1
    bcm2835 HDMI <span class="m">1</span>
    USB Stream Output
</pre></div>
</div>
</div>
<p>以下是 <a class="reference internal" href="../../kali_linux/index.html#kali-linux"><span class="std std-ref">Kali Linux</span></a> 在 <a class="reference internal" href="../../../arm/raspberry_pi/hardware/pi_400.html#pi-400"><span class="std std-ref">树莓派Raspberry Pi 400</span></a> 的配置案例:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">~/.config/mpd/mpd.conf audio_output 配置案例</span><a class="headerlink" href="#id9" title="此代码块的永久链接">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>audio_output <span class="o">{</span>
        <span class="nb">type</span>          <span class="s2">&quot;alsa&quot;</span>
        name          <span class="s2">&quot;ALSA sound card&quot;</span>
        device        <span class="s2">&quot;hw:CARD=b1,DEV=0&quot;</span>
        mixer_type      <span class="s2">&quot;hardware&quot;</span>
        mixer_device    <span class="s2">&quot;default&quot;</span>
        mixer_control   <span class="s2">&quot;PCM&quot;</span>
        mixer_index <span class="s2">&quot;0&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>但是我在 <code class="docutils literal notranslate"><span class="pre">Raspberry</span> <span class="pre">Pi</span> <span class="pre">OS</span></code> 上执行 <code class="docutils literal notranslate"><span class="pre">aplay</span> <span class="pre">--list-pcm</span></code> 显示的信息就和 <a class="reference internal" href="../../kali_linux/index.html#kali-linux"><span class="std std-ref">Kali Linux</span></a> 不同，如下:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Raspberry Pi OS 上 aplay –list-pcm 输出信息</span><a class="headerlink" href="#id10" title="此代码块的永久链接">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>null
    Discard all samples <span class="o">(</span>playback<span class="o">)</span> or generate zero samples <span class="o">(</span>capture<span class="o">)</span>
default
    Default Audio Device
sysdefault
    Default Audio Device
hw:CARD<span class="o">=</span>vc4hdmi0,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-0, MAI PCM i2s-hifi-0
    Direct hardware device without any conversions
plughw:CARD<span class="o">=</span>vc4hdmi0,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-0, MAI PCM i2s-hifi-0
    Hardware device with all software conversions
default:CARD<span class="o">=</span>vc4hdmi0
    vc4-hdmi-0, MAI PCM i2s-hifi-0
    Default Audio Device
sysdefault:CARD<span class="o">=</span>vc4hdmi0
    vc4-hdmi-0, MAI PCM i2s-hifi-0
    Default Audio Device
hdmi:CARD<span class="o">=</span>vc4hdmi0,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-0, MAI PCM i2s-hifi-0
    HDMI Audio Output
dmix:CARD<span class="o">=</span>vc4hdmi0,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-0, MAI PCM i2s-hifi-0
    Direct sample mixing device
hw:CARD<span class="o">=</span>vc4hdmi1,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-1, MAI PCM i2s-hifi-0
    Direct hardware device without any conversions
plughw:CARD<span class="o">=</span>vc4hdmi1,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-1, MAI PCM i2s-hifi-0
    Hardware device with all software conversions
default:CARD<span class="o">=</span>vc4hdmi1
    vc4-hdmi-1, MAI PCM i2s-hifi-0
    Default Audio Device
sysdefault:CARD<span class="o">=</span>vc4hdmi1
    vc4-hdmi-1, MAI PCM i2s-hifi-0
    Default Audio Device
hdmi:CARD<span class="o">=</span>vc4hdmi1,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-1, MAI PCM i2s-hifi-0
    HDMI Audio Output
dmix:CARD<span class="o">=</span>vc4hdmi1,DEV<span class="o">=</span><span class="m">0</span>
    vc4-hdmi-1, MAI PCM i2s-hifi-0
    Direct sample mixing device
</pre></div>
</div>
</div>
<p>但是，我在 <code class="docutils literal notranslate"><span class="pre">Raspberry</span> <span class="pre">Pi</span> <span class="pre">OS</span></code> 没有找到如 <a class="reference internal" href="../../kali_linux/index.html#kali-linux"><span class="std std-ref">Kali Linux</span></a> 的配置设备方法，反而是完全遵循 <a class="reference external" href="https://wiki.debian.org/mpd">Debian Wiki: mpd</a> ，即不配置任何设备，只设置:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">audio_output</span> <span class="p">{</span>
        <span class="nb">type</span>            <span class="s2">&quot;alsa&quot;</span>
        <span class="n">name</span>            <span class="s2">&quot;My ALSA Device&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>却完全工作正常。所以我在 <code class="docutils literal notranslate"><span class="pre">Raspberry</span> <span class="pre">Pi</span> <span class="pre">OS</span></code> 使用的是如下配置:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">我现在在Raspberry Pi OS 使用的 ~/.config/mpd/mpd.conf 配置</span><a class="headerlink" href="#id11" title="此代码块的永久链接">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 数据库</span>
db_file         <span class="s2">&quot;~/.config/mpd/database&quot;</span>

<span class="c1"># 日志</span>
log_file            <span class="s2">&quot;~/.config/mpd/log&quot;</span>

<span class="c1"># 音乐目录</span>
music_directory        <span class="s2">&quot;~/Music&quot;</span>

<span class="c1"># Uncomment to refresh the database whenever files in the music_directory are changed</span>
auto_update <span class="s2">&quot;yes&quot;</span>

<span class="c1"># Uncomment to enable the functionalities</span>
playlist_directory <span class="s2">&quot;~/.config/mpd/playlists&quot;</span>
pid_file           <span class="s2">&quot;~/.config/mpd/pid&quot;</span>
state_file         <span class="s2">&quot;~/.config/mpd/state&quot;</span>
sticker_file       <span class="s2">&quot;~/.config/mpd/sticker.sql&quot;</span>

<span class="c1"># Raspberry Pi OS 只需要配置 alsa 类型设备，无需详细配置</span>
audio_output <span class="o">{</span>
        <span class="nb">type</span>          <span class="s2">&quot;alsa&quot;</span>
        name          <span class="s2">&quot;ALSA sound card&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>我在实践中发现，当使用 <a class="reference internal" href="alsa.html#alsa"><span class="std std-ref">ALSA内核声音子系统</span></a> 直接作为音频输出设备，但是同时运行 <a class="reference internal" href="pulseaudio.html#pulseaudio"><span class="std std-ref">PulseAudio</span></a> 服务，则在 <a class="reference internal" href="../../../arm/raspberry_pi/hardware/pi_400.html#pi-400"><span class="std std-ref">树莓派Raspberry Pi 400</span></a> 的HDMI输出声音中总是有沙沙的噪音。杀掉 <code class="docutils literal notranslate"><span class="pre">pulseaudio</span></code> 服务之后则恢复正常。</p>
<p>由于我在 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 中使用 <a class="reference internal" href="alsa.html#alsa"><span class="std std-ref">ALSA内核声音子系统</span></a> ，并且也配置了VLC直接使用ALSA，所以配置关闭了 <a class="reference internal" href="pulseaudio.html#pulseaudio"><span class="std std-ref">PulseAudio</span></a> 服务</p>
</div>
</section>
<section id="systemd">
<h3>以 <a class="reference internal" href="../../redhat_linux/systemd/index.html#systemd"><span class="std std-ref">Systemd进程管理器</span></a> 自动启动<a class="headerlink" href="#systemd" title="此标题的永久链接">¶</a></h3>
<ul>
<li><p>执行以下命令启动 user unit mpd.service:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">mpd</span><span class="o">.</span><span class="n">service</span> <span class="o">--</span><span class="n">user</span>
</pre></div>
</div>
</li>
</ul>
<p>则配置文件将读取 <code class="docutils literal notranslate"><span class="pre">~/.config/mpd/mpd.conf</span></code></p>
</section>
<section id="tty-login">
<h3>以 tty login自动启动<a class="headerlink" href="#tty-login" title="此标题的永久链接">¶</a></h3>
<p>如果要在tty登陆时候自动启动mpd，则配置 <code class="docutils literal notranslate"><span class="pre">~/.profile</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># MPD daemon start (if no other user instance exists)
[ ! -s ~/.config/mpd/pid  ] &amp;&amp; mpd ~/.config/mpd/mpd.conf
</pre></div>
</div>
</section>
</section>
<section id="id5">
<h2>客户端<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h2>
<section id="ncmpc">
<h3>字符终端 <code class="docutils literal notranslate"><span class="pre">ncmpc</span></code><a class="headerlink" href="#ncmpc" title="此标题的永久链接">¶</a></h3>
<p>如果你像我一样追求轻量级应用，不需要任何花哨的界面，你可以像我一样使用字符终端mpd客户端，例如 <code class="docutils literal notranslate"><span class="pre">ncmpc</span></code></p>
<ul class="simple">
<li><p>在终端执行 <code class="docutils literal notranslate"><span class="pre">ncmpc</span></code> 命令，会打开基于 <code class="docutils literal notranslate"><span class="pre">ncurse</span></code> 的控制台，并且立即连接到默认的本地 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 服务上，此时就可以看到服务器上所有的音乐</p></li>
<li><p>在导航栏上的数字 <code class="docutils literal notranslate"><span class="pre">1</span></code> <code class="docutils literal notranslate"><span class="pre">2</span></code> … 分别代表 <code class="docutils literal notranslate"><span class="pre">F1</span></code> <code class="docutils literal notranslate"><span class="pre">F2</span></code> … 以此类推，最后2个字母分别是小写的 <code class="docutils literal notranslate"><span class="pre">i</span></code> 和大写的 <code class="docutils literal notranslate"><span class="pre">K</span></code> ，真的是对应操作键 <code class="docutils literal notranslate"><span class="pre">i</span></code> 和 <code class="docutils literal notranslate"><span class="pre">K</span></code> ，总之，按照对应操作键进入菜单就会明白怎么操作。</p></li>
<li><p>快捷键的绑定在 <code class="docutils literal notranslate"><span class="pre">K</span></code> 上，通过上下键找到操作命令，按下回车就可以看到命令对应绑定的快捷键，例如:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> 表示选择所有</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> 表示将选择的项添加到队列</p></li>
</ul>
</li>
<li><p>将音乐加入到队列中之后，就可以在队列中按下回车开始依次聆听</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>使用 <code class="docutils literal notranslate"><span class="pre">ncmpc</span></code> 这样的客户端来使用 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 播放音乐的优点是只要激活播放，就可以关闭客户端程序，后台的 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 服务会继续工作，也就是继续播放音乐。前端客户端其实只是起一个控制作用。也就是说，设置可以使用 <a class="reference internal" href="../sway/index.html#sway"><span class="std std-ref">sway - i3兼容Wayland compositor</span></a> 快捷键来管理 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 的常规播放，就好像在 Mac 电脑上，可以使用键盘按键来操作音乐播放一般，非常酷。</p>
</div>
</section>
<section id="qt5-cantata">
<h3>QT5图形 <code class="docutils literal notranslate"><span class="pre">cantata</span></code><a class="headerlink" href="#qt5-cantata" title="此标题的永久链接">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">cantata</span></code> 实际上不需要上述手工配置 <code class="docutils literal notranslate"><span class="pre">mpd.conf</span></code> ，因为只要系统中安装了 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> ， <code class="docutils literal notranslate"><span class="pre">cantata</span></code> 启动时候就会自动引导你做一些简单配置(也就是选择音乐所在目录)，然后程序运行起来以后，你就会看到后台运行了一个 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 服务并且使用了 <code class="docutils literal notranslate"><span class="pre">cantata</span></code> 自动生成的 <code class="docutils literal notranslate"><span class="pre">mpd.conf</span></code> 配置文件。</p>
<p>简单来说， <code class="docutils literal notranslate"><span class="pre">cantata</span></code> 提供了自动配置 <code class="docutils literal notranslate"><span class="pre">mpd</span></code> 的功能来帮助你简化使用。不过，需要注意，在 <a class="reference internal" href="../../../arm/raspberry_pi/hardware/pi_400.html#pi-400"><span class="std std-ref">树莓派Raspberry Pi 400</span></a> 上必须使用 HDMI 作为音频设备，这个配置需要手工添加，见上文。</p>
</section>
</section>
<section id="id6">
<h2>参考<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://mpd.readthedocs.io/en/stable/user.html">MPD User’s Manual</a></p></li>
<li><p><a class="reference external" href="https://wiki.archlinux.org/title/Music_Player_Daemon">arch linux: Music Player Daemon</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="play_music_on_linux.html" class="btn btn-neutral float-left" title="在Linux环境播放音乐" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../xorg_dpi_fix.html" class="btn btn-neutral float-right" title="修正xorg显示dpi" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../copyright.html"> 版权所有</a> 2018 - now, Huatai Huang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
    <!-- your html code here -->
    <br>
    <p><a href="https://github.com/huataihuang/cloud-atlas/issues">留言和讨论</a>|<a href="https://github.com/huataihuang/cloud-atlas/blob/master/source/donate.rst">请我喝一杯咖啡</a></p>
     


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>