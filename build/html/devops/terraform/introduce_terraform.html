

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Terraform简介 &mdash; Cloud Atlas 0.1 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="copyright" title="版权所有" href="../../copyright.html" />
    <link rel="next" title="安装Terraform" href="install_terraform.html" />
    <link rel="prev" title="Terraform基础架构管理平台" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Cloud Atlas
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../studio/index.html">Studio Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infrastructure/index.html">Infrastructure Atlas</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">DevOps Atlas</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../thought/index.html">DevOps 思考集锦</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sre/index.html">SRE - 站点可靠性工程师</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jenkins/index.html">Jenkins</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Terraform基础架构管理平台</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Terraform简介</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#devops">DevOps实现方式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">架构即代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Terraform适用场景</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">Terraform工作原理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install_terraform.html">安装Terraform</a></li>
<li class="toctree-l3"><a class="reference internal" href="terraform_aliyun_demo.html">阿里云Terraform Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="terraform_module.html">Terraform Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="terraform_ansible.html">结合Terraform和Ansible部署基础架构</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../kvm/index.html">KVM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph/index.html">Ceph Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gluster/index.html">Gluster Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ovirt/index.html">oVirt Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openstack/index.html">OpenStack Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/index.html">Docker Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kubernetes/index.html">Kubernetes Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openshift/index.html">OpenShift Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mysql/index.html">MySQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web/index.html">Web Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../big_data/index.html">Big Data Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../machine_learning/index.html">Machine Learning Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/index.html">Linux Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel/index.html">Kernel Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributed_system/index.html">Distributed System Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Python Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../django/index.html">Django Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arm/index.html">ARM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../android/index.html">Android Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../macos_ios/index.html">macOS &amp; iOS Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../windows/index.html">Windows Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../real/index.html">Real Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/index.html">附录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutme.html">关于作者</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../donate.html">捐助</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../thanks.html">感谢</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cloud Atlas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">DevOps Atlas</a> &raquo;</li>
        
          <li><a href="index.html">Terraform基础架构管理平台</a> &raquo;</li>
        
      <li>Terraform简介</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/devops/terraform/introduce_terraform.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="terraform">
<span id="introduce-terraform"></span><h1>Terraform简介<a class="headerlink" href="#terraform" title="永久链接至标题">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>为什么我们需要Terraform？</p>
<p>原因就是各个云计算厂商的SDK过于复杂和千差万别，导致编写简单的操作过程也需要重复投入资源。Terraform就是云计算基础设施的配置管理工具，通过标准配置提供虚拟机和虚拟网络、虚拟存储等底层基础设施，并编排组成最基础的物理架构。</p>
<p>你可以把Terraform想象成操作(虚拟)硬件设备的Ansible/Chef这样的配置管理工具，只不过比传统的配置管理工具(需要先有VM服务器)更低一层，提供的是基础设备的配置管理。</p>
<p>之后，Ansible/Puppet就可以登场，在Terraform构建的底层系统上部署软件应用。或者，也可以使用给予镜像容器的Kubernetes来构IaaS。</p>
</div>
<p>长期以来，数据中心部署是由系统管理员负责，从零开始，一步步手工安装每个服务器，每个数据库，每个负载均衡，以及手工配置网络。这是一个非常黑暗而痛苦的过程：宕机、错误配置以及缓慢而重复的安装配置。</p>
<p><a class="reference internal" href="../index.html#devops"><span class="std std-ref">DevOps Atlas</span></a> 的兴起，极大程度减轻了系统管理员的工作负担，可以采用申明式语言描述来实现自动化部署，无需每个系统管理员低效地编写”匆忙而未经充分测试”的脚本。随着云计算的兴起，有带来的新的挑战：每个云计算厂商提供的API以及资源都存在不兼容情况，就如同早期系统工程师需要面对不同厂商的数据库、网络设备和操作系统。</p>
<p>Terraform则应运而生，提供了不同云厂商的统一抽象，实现了将IaaS视为简单的、精心定义的语言程序，实现在不同云厂商统一的管理架构。不论你使用的是AWS，Azure，Google Cloud，阿里云，以及私有云计算平台(例如，OpenStack，VMware)，都能使用很少的命令完成复杂的部署。</p>
<p>Terraform是一个用于构建、修改和版本控制的基础架构。</p>
<p>配置文件描述Terraform组件需要运行一个单一程序或者整个数据中心。Terraform生成一个执行计划来描述如何达到指定状态，然后执行这个计划构建所描述的架构。当配置文件修改，Terraform能够检测到配置修改并创建增量执行计划来完成。</p>
<p>Terraform能够管理的架构包括底层组件，例如计算实例，存储和网络，以及高层组件，如DNS对象，SaaS功能等等。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>参考资料</p>
<ul class="simple">
<li><p>YouTube上有Terraform的开发公司 <a class="reference external" href="https://www.youtube.com/channel/UC-AdvAxaagE9W2f0webyNUQ">HashiCorp的订阅频道</a> 提供了很多视频参考资料。
- 《Terraform: Up &amp; Running》作者Yevgeniy Brikman的演讲 <a class="reference external" href="https://www.youtube.com/watch?v=LVgP63BkhKQ&amp;pbjreload=10">How to Build Reusable, Composable, Battle tested Terraform Modules</a></p></li>
<li><p>阿里云提供了Terraform的provider，继承了Terraform的很多resource和datasource，并且提供了Terraform学习案例 <a class="reference external" href="https://yq.aliyun.com/articles/713099">玩转阿里云Terraform</a> :
- <a class="reference external" href="https://yq.aliyun.com/articles/713099">Terraform 是什么</a>
- <a class="reference external" href="https://yq.aliyun.com/articles/721188">Terraform 的几个关键概念</a>
- <a class="reference external" href="https://yq.aliyun.com/articles/726467">Terraform 的安装和加速</a>
- <a class="reference external" href="https://yq.aliyun.com/articles/727057">Terraform 常用命令详解</a></p></li>
</ul>
</div>
<div class="section" id="devops">
<h2>DevOps实现方式<a class="headerlink" href="#devops" title="永久链接至标题">¶</a></h2>
<div class="section" id="configuration-management-tools">
<h3>配置管理工具(Configuration Management Tools)<a class="headerlink" href="#configuration-management-tools" title="永久链接至标题">¶</a></h3>
<p>Chef, Puppet, Ansible, SaltStac等配置管理工具设计成对现有服务器进行安装和管理软件以及配置文件来实现DevOps：</p>
<ul class="simple">
<li><p>代码转换成一致性，可预测结构：清晰的结构和命名参数</p></li>
<li><p>结合脚本实现</p></li>
<li><p>分布式分发执行</p></li>
</ul>
</div>
<div class="section" id="server-templating-tools">
<h3>服务器模板工具(Server Templating Tools)<a class="headerlink" href="#server-templating-tools" title="永久链接至标题">¶</a></h3>
<p>服务器模板工具类似 Docker, Packer 和 Vargant。和配置管理工具不同，配置管理工具是在服务器上运行相同代码，而服务器模板工具则采用完全自包含的快照，所有软件，文件和相关配置都在一个镜像中。</p>
<div class="figure align-default" id="id16">
<a class="reference internal image-reference" href="../../_images/vm_container.png"><img alt="../../_images/vm_container.png" src="../../_images/vm_container.png" style="width: 570.0px; height: 402.5px;" /></a>
<p class="caption"><span class="caption-text">两种不同类型的镜像：虚拟机(VM)和容器(Container)</span><a class="headerlink" href="#id16" title="永久链接至图片">¶</a></p>
</div>
</div>
<div class="section" id="server-provisioning-tools">
<h3>服务器供给工具(Server Provisioning Tools)<a class="headerlink" href="#server-provisioning-tools" title="永久链接至标题">¶</a></h3>
<p>虽然配置管理工具和服务器模板工具都定义了在每个服务器上运行的代码，但是服务器供给工具(Server Provisioning Tools)，例如Terraform, CloudFormation, OpenStack Heat提供了另一种DevOps模式：可以创建服务器，数据库，缓存，负载均衡，消息队列，监控，网络配置，SSL证书，几乎是所有的基础架构。</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../../_images/server_provision_tool.png"><img alt="../../_images/server_provision_tool.png" src="../../_images/server_provision_tool.png" style="width: 315.5px; height: 660.0px;" /></a>
</div>
<p>Terraform案例代码:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resoure</span> <span class="s2">&quot;aws_instance&quot;</span> <span class="s2">&quot;app&quot;</span> <span class="p">{</span>
  <span class="n">instance_type</span> <span class="o">=</span> <span class="s2">&quot;t2.micro&quot;</span>
  <span class="n">availability_zone</span> <span class="o">=</span> <span class="s2">&quot;us-east-1a&quot;</span>
  <span class="n">ami</span> <span class="o">=</span> <span class="s2">&quot;ami-40d8157&quot;</span>

  <span class="n">user_data</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="n">EOF</span>
              <span class="c1">#!/bin/bash</span>
              <span class="n">sudo</span> <span class="n">service</span> <span class="n">apache2</span> <span class="n">start</span>
              <span class="n">EOF</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>架构即代码<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>Infrastructure as Code(架构即代码)是指，架构通过高层次配置语法进行描述。这样可以使得数据中心的蓝图能够版本化并且就好象代码一样。此外，这样也可以使得架构能够分享和重用。</p>
<div class="section" id="id7">
<h3>执行计划<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>Terraform使用一个”planning”步骤来生成一个执行计划。这个执行计划显示了当你apply的时候Terraform将做什么。</p>
</div>
<div class="section" id="id8">
<h3>资源图形<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>Terraform构建了你所有资源的一个图形，并且并发创建和修改任何没有依赖的资源。正因为这样，Terraform构建架构的效率尽可能高，并且操作者可以深入他们架构的依赖关系。</p>
</div>
<div class="section" id="id9">
<h3>变更自动化<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>复杂的变更集合可以以最小的人工干预在基础架构上实施。通过执行计划和资源图形，你可以精确了解Terraform将要修改的内容以及顺序，避免很多人为错误。</p>
</div>
</div>
<div class="section" id="id10">
<h2>Terraform适用场景<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>官方文档描述的多个场景我现在没有经验，我需要更多实践来验证，目前仅记录我理解和能够实施的场景。</p>
</div>
<div class="section" id="id11">
<h3>多层次应用程序<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>Terraform特别适合部署N-层次应用程序，例如WEB服务+数据库，以及更为复杂的API服务器，缓存服务器，路由mesh等等。Terraform是一个理想的构建和管理这些架构的工具，每个层次都被描述为一组资源集合，以及描述每个层次之间依赖并自动处理。Terraform会确保数据库层次在WEB服务器启动之前就绪，并且负载均衡对WEB节点可用。每个层次都是容易伸缩的，Terraform通过修改一个简单的 <code class="docutils literal notranslate"><span class="pre">count</span></code> 配置值来实现。</p>
</div>
<div class="section" id="sdn">
<h3>软件定义网络(SDN)<a class="headerlink" href="#sdn" title="永久链接至标题">¶</a></h3>
<p>Terraform可以通过编码配置方式来定义软件定义网络，这个配置通过Terraform自动设置和修改控制曾的接口。例如各种运计算服务商的基础网络设施，例如AWS VPC。</p>
</div>
<div class="section" id="id12">
<h3>资源调度<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>在大型伸缩架构中，静态分配应用程序到主机上运行是极大的困难，这就产生了大量的调度器，例如Borg，Mesos，YARN和 Kubernetes。这些调度器用于动态调度Docker容器，Hadoop，Spark以及其他软件。</p>
<p>Terraform不限于AWS，而是将资源调度器是为provider，这样Terraform就能够设置运行这些调度器微微调度器网格。</p>
</div>
<div class="section" id="id13">
<h3>多云部署<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p>Terraform提供了多个云计算部署的抽象，这样可以使用单一配置来实现管理多个provider，甚至跨云部署。</p>
</div>
</div>
<div class="section" id="id14">
<h2>Terraform工作原理<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h2>
<p>通过Terraform部署架构：</p>
<ul class="simple">
<li><p>使用不同provider的API，包装抽象成Terraform的标准代码结构</p></li>
<li><p>用户不需要了解每个云计算厂商的API细节，降低了部署难度</p></li>
</ul>
</div>
<div class="section" id="id15">
<h2>参考<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.terraform.io/intro/index.html">Terraform官方文档 - Introduction to Terraform</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=Ym6DtUx5REg">Webinar: Controlling Your Organization With HashiCorp Terraform and Google Cloud Platform</a></p></li>
<li><p><a class="reference external" href="https://youtu.be/nLg7fpVcIv4">Webinar: Multi-Cloud, One Command with Terraform</a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="install_terraform.html" class="btn btn-neutral float-right" title="安装Terraform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Terraform基础架构管理平台" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../../copyright.html">Copyright</a> 2019, Huatai Huang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <!-- your html code here -->
    <br>
    <p><a href="https://github.com/huataihuang/cloud-atlas/issues">留言和讨论</a>|<a href="https://github.com/huataihuang/cloud-atlas/blob/master/source/donate.rst">请我喝一杯咖啡</a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>