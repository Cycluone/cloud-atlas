

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Kubernetes概览 &mdash; Cloud Atlas 0.1 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权所有" href="../copyright.html" />
    <link rel="next" title="Kubernetes快速起步" href="startup/index.html" />
    <link rel="prev" title="Kubernetes Atlas" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Cloud Atlas
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../studio/index.html">Studio Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/index.html">Infrastructure Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devops/index.html">DevOps Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kvm/index.html">KVM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/index.html">Ceph Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gluster/index.html">Gluster Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ovirt/index.html">oVirt Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/index.html">OpenStack Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker Atlas</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Kubernetes Atlas</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Kubernetes概览</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">什么是Kubernetes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Kubernetes集群的架构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#control-plane">管控平台（Control Plane)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nodes">节点（nodes）</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">在Kubernetes中运行应用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">描述对于运行的容器的作用</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">保持容器始终运行</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">运行副本的伸缩性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">稳定的服务访问入口</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Kubernetes的优势</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">简化应用部署</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">充分发挥硬件能力</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">健康检查和自愈</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">自动伸缩性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">简化应用程序部署</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="startup/index.html">Kubernetes快速起步</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts/index.html">Kubernetes概念辨析</a></li>
<li class="toctree-l2"><a class="reference internal" href="startup_prepare/index.html">Kubernetes起步准备</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment/index.html">Kubernetes部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="manage_object/index.html">Kubernetes管理对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="administer/index.html">Kubernetes管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="access_application/index.html">Kubernetes访问应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="configure/index.html">Kubernetes 配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="network/index.html">Kubernetes网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="production/index.html">Kubernetes生产环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="service_mesh/index.html">Service Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="istio/index.html">Istio服务网格</a></li>
<li class="toctree-l2"><a class="reference internal" href="serverless/index.html">Kubernetes Severless</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci_cd/index.html">Kubernetes持续集成和持续部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitor/index.html">Kubernetes监控</a></li>
<li class="toctree-l2"><a class="reference internal" href="debug/index.html">Kubernetes排查</a></li>
<li class="toctree-l2"><a class="reference internal" href="knative/index.html">Knative - Serverless计算</a></li>
<li class="toctree-l2"><a class="reference internal" href="security/index.html">Kubernetes安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtual/index.html">Kubernetes结合虚拟化</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloud/index.html">Kubernetes云厂商</a></li>
<li class="toctree-l2"><a class="reference internal" href="develop/index.html">Kubernetes开发</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../openshift/index.html">OpenShift Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/index.html">MySQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/index.html">Web Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../big_data/index.html">Big Data Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine_learning/index.html">Machine Learning Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel/index.html">Kernel Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distributed_system/index.html">Distributed System Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../django/index.html">Django Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../android/index.html">Android Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../macos_ios/index.html">macOS &amp; iOS Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../real/index.html">Real Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">附录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutme.html">关于作者</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">捐助</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thanks.html">感谢</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cloud Atlas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Kubernetes Atlas</a> &raquo;</li>
        
      <li>Kubernetes概览</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/kubernetes/kubernetes_overview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kubernetes">
<span id="kubernetes-overview"></span><h1>Kubernetes概览<a class="headerlink" href="#kubernetes" title="永久链接至标题">¶</a></h1>
<div class="section" id="id1">
<h2>什么是Kubernetes<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>Kubernetes是一个容器( <a class="reference internal" href="../docker/index.html#docker"><span class="std std-ref">Docker Atlas</span></a> )调度管理系统，使得单机运行的容器能够在整个数据中心范围进行调度和运行。请把容器想象成一个进程，就如同单台主机中的进程能够在该主机的多处理器（SMP）上调度运行，如果将整个数据中心视为超级计算机，Kubernetes赋予了容器如同进程一样在成百上千的主机节点（类似单机的CPU核心）间调度运行。</p>
<p>Kubernetes抽象了数据中心的硬件基础设施，对外展示为一个巨大的资源池。这样部署和运行组件是，不用关注底层服务器。调度组件是由Kubernetes负责，并确保组件能够相互发现，互相通讯。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>如果从集群角度来看，Kubernetes确实具备了一定的操作系统能力：将每个Host主机视为一个网络CPU，则Kubernetes把整个数据中心组成了一台逻辑超级服务器，调度容器运行。</p>
<p>当然，还有存储、网络技术的组合，才能实现一个完整的网络操作系统。</p>
</div>
<p>如果说 docker ( <a class="reference internal" href="../docker/index.html#docker"><span class="std std-ref">Docker Atlas</span></a> ) 使得开发人员不再关注软件运行环境，那么Kubernetes就进一步改进使得开发人员不再关注软件运行如何部署到数据中心。</p>
<a class="reference internal image-reference" href="../_images/kubernetes_deployment_platform.png"><img alt="../_images/kubernetes_deployment_platform.png" src="../_images/kubernetes_deployment_platform.png" style="width: 561.0px; height: 232.0px;" /></a>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>开发人员只需要描述应用，就可以通过 <code class="docutils literal notranslate"><span class="pre">Kubernetes</span> <span class="pre">master</span></code> 将容器部署到数据中心到成百上千的服务器集群中。不论是开发人员还是运维人员，不需要关注容器具体运行在哪个服务器上，Kubernetes会负责完成容器的启动并保持运行，并在适当的时候销毁和重建容器。</p>
</div>
<p>Kubernetes将容器化的应用部署到集群中运行，并且提供了容器应用互相发现的标准化机制，这样无数的应用可以作为一个整体来运行。应用程序不需要关注其自身运行的节点，Kubernetes会随时调度应用到任意节点，混合不同的应用运行在数据中心的各个主机上，通过一定的性能检测和调度计算，使得数据中心的服务器资源充分发挥性能。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>现代应用开发趋势是将大型单体应用拆分成小型微服务，并且应用运行的基础架构转为容器化运行。</p>
<p>微服务组件以小型的可以独立部署的服务组件被部署到不同服务器上，并通过定义良好的接口(API)互相通讯协作。服务之间可以通过类似HTTP这样的同步协议，或者通过AMQP这样的异步协议通信。由于互相通信的协议标准化，所以微服务可以使用不同的语言进行开发。只要保证API不变或者向前兼容，就可以不断对微服务进行升级而不影响其他微服务或者不需要其他微服务重新部署。</p>
<p>微服务的另外一个优势是只需要扩容整个系统中负载增加的部分服务组件，从而节约计算资源。</p>
<p>但是，微服务也带来了复杂性：微服务需要以整体方式完成工作，所以需要正确配置所有微服务以使其能够作为一个单一系统进行正确工作。随着微服务数量不断增加，配置工作变得冗杂且易错。</p>
<p>此外，由于微服务跨多个进程和服务器，使得调试代码和定位异常调用变得困难，同时也带来了通讯开销。</p>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>Kubernetes的分布式微服务架构带来软件异常排查调试非常困难， <a class="reference internal" href="monitor/jaeger/index.html#jaeger"><span class="std std-ref">Jaeger分布式跟踪系统</span></a> 和 <a class="reference external" href="https://zipkin.io/">Zipkin</a> 是两种广泛使用的分布式跟踪系统，通过采集计时数据来排查延迟问题。</p>
</div>
</div>
<div class="section" id="id2">
<h2>Kubernetes集群的架构<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<a class="reference internal image-reference" href="../_images/kubernetes_architecture.png"><img alt="../_images/kubernetes_architecture.png" src="../_images/kubernetes_architecture.png" style="width: 562.0px; height: 217.0px;" /></a>
<div class="section" id="control-plane">
<h3>管控平台（Control Plane)<a class="headerlink" href="#control-plane" title="永久链接至标题">¶</a></h3>
<p>管控平台（Control Plane）是管控整个集群并使之工作的组成，包含了多个组件。这些组件可以运行在单一的master节点，也可以分散在多个节点并互相复制以确保高可用。管控平台的组件包括:</p>
<ul class="simple">
<li><p>Kubernetes API Server (API服务): 交互所访问或者其他管控平台通讯的中心</p></li>
<li><p>Scheduler (调度器): 调度应用到不同工作节点</p></li>
<li><p>Controller Manager (控制管理器): 执行集群级别的功能，例如复制组件，跟踪工作节点，处理节点失效等等</p></li>
<li><p>etcd : 一个可靠的分布式数据存储，用于持久化存户集群配置</p></li>
</ul>
<p>管控平台的组件负责获取和控制集群的状态，但不会用于运行应用程序。应用程序（的容器）由worker节点负责。</p>
</div>
<div class="section" id="nodes">
<h3>节点（nodes）<a class="headerlink" href="#nodes" title="永久链接至标题">¶</a></h3>
<p>worker节点是运行容器化应用程序的服务器。负责运行、监控和向应用程序提供服务的任务由以下组件负责：</p>
<ul class="simple">
<li><p>docker、rkt或者其他容器运行环境，负责运行容器</p></li>
<li><p>kubelet 负责和API服务器通讯以及管理各自节点上的容器</p></li>
<li><p>kube-proxy (Kubernetes Service Proxy) 负责在不同的应用组件负载均衡网络流量</p></li>
</ul>
</div>
</div>
<div class="section" id="id3">
<h2>在Kubernetes中运行应用<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>要在Kubernetes中运行一个应用程序，首先需要将应用程序打包到一个或多个容器镜像，将镜像推送到镜像中心（image registry），然后通过提交一个应用到描述给Kubernetes API服务器来实现。</p>
<p>这个描述信息包括诸如容器镜像或包含应用组件的镜像，组件互相之间的关系，组件之间的依赖（例如需要需要运行在同一个节点或者不能运行在同一个节点）。对于每个组件，也可以指定副本数量（或 <code class="docutils literal notranslate"><span class="pre">replicas</span></code> ）。此外，描述也可以包括这些组件提供给内部或外部客户的服务，以及如何通过一个单一IP地址输出，或者组件对于其他组件如何能够被发现。</p>
<div class="section" id="id4">
<h3>描述对于运行的容器的作用<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>当API服务器处理应用的描述，则调度器（seheduler）会基于每个组请求的计算资源编排指定组的容器到可用的工作节点，并且释放需要的资源。每个节点上的Kubelet就会命令容器运行环境（例如Docker）去下载需要的容器镜像，然后运行容器。</p>
<a class="reference internal image-reference" href="../_images/kubernetes_run_application.png"><img alt="../_images/kubernetes_run_application.png" src="../_images/kubernetes_run_application.png" style="width: 615.0px; height: 444.0px;" /></a>
<p>上述示意图中，app descriptor（应用描述）列出了4个容器，划分为3个集合（set），这些集合在Kubernetes中称为 <code class="docutils literal notranslate"><span class="pre">pods</span></code> 。前两个pods每个只包含一个单一容器，而最后一个pod则包含了2个容器（这意味着这两个容器必须一起运行相互不能隔离）。每个pod在描述中还包括了副本数量，也就是需要并行运行的同一个pod的副本数量。</p>
<p>当描述发送给Kubernetes，Kubernetes就会调度每个pod的指定数量副本部署到可用的工作节点。在集群节点上运行的Kubelet服务则会调用Docker来下载容器镜像并运行容器。</p>
</div>
<div class="section" id="id5">
<h3>保持容器始终运行<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>一旦应用开始运行，Kubernetes会一直确保应用的部署状态和你提供的描述相一致。例如，如果你指定希望web服务器保持5个实例，则Kubernetes就会确保有5个实例运行。如果某个实例停止意外停止，例如crash或者停止响应，Kubernetes会自动重启该容器。类似，如果整个worker节点都死掉或者不可访问，Kubernetes将为所有运行在该节点上的容器选择新的节点来运行。</p>
</div>
<div class="section" id="id6">
<h3>运行副本的伸缩性<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<p>当应用运行时，可以决定增加或缩减运行副本数量，Kubernetes会相应增加或停止副本。这个伸缩操作可以基于实时监控，例如CPU负载，内存消耗，每秒的查询量以及其他指定的应用监控项。</p>
</div>
<div class="section" id="id7">
<h3>稳定的服务访问入口<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>由于Kubernetes可能会在集群中不断调度容器实例，所以需要Kubernetes对外输出稳定的服务，例如固定的IP地址并将地址输出给运行在集群中的其他应用。这可以通过环境变量，或者DNS解析。Kube-proxy可以确保服务被负载均衡分发到所有提供这个服务的容器上，这样的对外输出IP地址是不变的，以便客户端能够稳定连接。</p>
</div>
</div>
<div class="section" id="id8">
<h2>Kubernetes的优势<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<div class="section" id="id9">
<h3>简化应用部署<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>Kubernetes将所有的工作节点输出成一个单一的部署平台，应用程序开发者可以自行启动部署应用而不需要了解集群中服务器如何部署应用。</p>
<p>Kubernetes通过标签分类使得集群底层的服务器能够按照不同的共性进行分组抽象，使得部署只需要按照分组就可以找到合适的资源。</p>
</div>
<div class="section" id="id10">
<h3>充分发挥硬件能力<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<p>Kubernetes能够基于应用程序的资源描述以及节点的可用资源，自动编排应用程序到最合适的节点运行应用。这个过程是自动完成，所以不需要开发者或部署者人工干预。由于避免了人工在繁杂的资源类型中排列组合，Kubernetes通过自动优化组合实现了应用的最佳部署。</p>
</div>
<div class="section" id="id11">
<h3>健康检查和自愈<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>Kubernetes监控应用组件以及运行的节点，在节点故障时可以自动重排应用运行节点。这种自动修复的能力使得系统管理员无需手工迁移应用，在资源充足的情况下，完全可以让系统自动修复，并在合适的时候集中人工处理。</p>
</div>
<div class="section" id="id12">
<h3>自动伸缩性<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>通过监控应用负载，Kubernetes提供了自动伸缩应用程序的运行实例数量，可以基于监控资源的使用自动调整每个应用的运行实例数量。</p>
</div>
<div class="section" id="id13">
<h3>简化应用程序部署<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p>Kubernetes内置了通过Kubernetes API方式获取应用环境以及依赖关系，这样应用部署可以简化。应用服务器可以查询Kubernetes API服务器获取环境变量或执行DNS查询。</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="startup/index.html" class="btn btn-neutral float-right" title="Kubernetes快速起步" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Kubernetes Atlas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../copyright.html">Copyright</a> 2019, Huatai Huang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <!-- your html code here -->
    <br>
    <p><a href="https://github.com/huataihuang/cloud-atlas/issues">留言和讨论</a>|<a href="https://github.com/huataihuang/cloud-atlas/blob/master/source/donate.rst">请我喝一杯咖啡</a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>