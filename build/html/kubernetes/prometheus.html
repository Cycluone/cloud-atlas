

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Prometheus（普罗米修斯）监控 &mdash; Cloud Atlas 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Grafana 数据分析监控平台" href="grafana.html" />
    <link rel="prev" title="cAdvisor容器性能分析组件" href="cadvisor.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Cloud Atlas
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../studio/index.html">Studio Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devops/index.html">DevOps Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kvm/index.html">KVM Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/index.html">Ceph Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/index.html">OpenStack Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker Atlas</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Kubernetes Atlas</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kubernetes_overview.html">Kubernetes概览</a></li>
<li class="toctree-l2"><a class="reference internal" href="startup_prepare/index.html">Kubernetes起步准备</a></li>
<li class="toctree-l2"><a class="reference internal" href="startup/index.html">Kubernetes快速起步</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts/index.html">Kubernetes概念辨析</a></li>
<li class="toctree-l2"><a class="reference internal" href="kubernetes_expose_service.html">输出Kubernetes应用服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="kubernetes_architecture.html">Kubernetes架构</a></li>
<li class="toctree-l2"><a class="reference internal" href="kubernetes_dashboard.html">Kubernetes仪表盘</a></li>
<li class="toctree-l2"><a class="reference internal" href="explore_google_gke.html">探索Google Kubernetes Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="configure_pods_and_containers.html">配置pod和容器</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator.html">Operator - Kubernetes应用打包部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator_startup.html">Operator快速起步</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment/index.html">Kubernetes部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="production/index.html">Kubernees生产环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci_cd/index.html">Kubernetes持续集成和持续部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="install_etcd.html">安装etcd</a></li>
<li class="toctree-l2"><a class="reference internal" href="recovery_etcd.html">etcd故障恢复</a></li>
<li class="toctree-l2"><a class="reference internal" href="istio.html">Istio架构</a></li>
<li class="toctree-l2"><a class="reference internal" href="service_mesh.html">Service Mesh架构</a></li>
<li class="toctree-l2"><a class="reference internal" href="k8s_ha_master.html">高可用Kubernetes Master</a></li>
<li class="toctree-l2"><a class="reference internal" href="admission_controllers.html">Admission Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="mutating_admission_webhook.html">MutatingAdmissionWebhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="validating_admission_webhook.html">ValidatingAdmissionWebhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="debug_node_notready.html">kubenetes节点”NotReady”状态排查</a></li>
<li class="toctree-l2"><a class="reference internal" href="cadvisor.html">cAdvisor容器性能分析组件</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Prometheus（普罗米修斯）监控</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">概览</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">功能</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">组件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">使用场景</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="grafana.html">Grafana 数据分析监控平台</a></li>
<li class="toctree-l2"><a class="reference internal" href="netdata.html">Netdata监控系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="kubevirt.html">KubeVirt虚拟机管理器</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mysql/index.html">MySQL Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../big_data/index.html">Big Data Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine_learning/index.html">Machine Learning Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kali_linux/index.html">Kali Linux Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel/index.html">Kernel Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">附录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutme.html">关于作者</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">捐助</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thanks.html">感谢</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cloud Atlas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Kubernetes Atlas</a> &raquo;</li>
        
      <li>Prometheus（普罗米修斯）监控</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/kubernetes/prometheus.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="prometheus">
<span id="id1"></span><h1>Prometheus（普罗米修斯）监控<a class="headerlink" href="#prometheus" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>概览<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://prometheus.io">Prometheus（普罗米修斯）监控</a> 是开源的系统监控和告警套装工具，最初由 <a class="reference external" href="http://soundcloud.com/">SoundCloud</a> 公司于2012年开发。Prometheus使用Go语言开发，并且采用Apache 2.0 license开源。Prometheus从2016年加入 <a class="reference external" href="https://cncf.io/">Cloud Native Computing Foundation, CNCF</a> ，成为Kubernetes之后第二个CNCF孵化项目。</p>
<p>Prometheus 提供了所有主流语言和运行环境的客户端库程序，包括 Go, Java/JVM, C#/.Net, Python, Ruby, Node.js, Haskell, Erlang 和 Rust。类似Kubernetes 和 Docker已经集成了Prometheus客户端库程序。对于第三方使用非Prometheus格式输出的软件，也有上百种集成方案。这种集成是通过 <code class="docutils literal notranslate"><span class="pre">exporters</span></code> 实现的，包括 HAProxy, MySQL, PostgreSQL, Redis, JMX, SNMP, Consul 和 Kafka等。</p>
<div class="section" id="id4">
<h3>功能<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Prometheus主要功能包括：</p>
<ul class="simple">
<li>一种具有 <strong>通过度量名称(metric name)和键值对来标识的时序数据</strong> 的多维度数据模型(data model)</li>
<li>PromQL，一种具有伸缩行的查询语言，可以衡量不同维度</li>
<li>不依赖分布式存储; 单个服务器节点是自治的</li>
<li>通过HTTP的拉取模式采集时序数据</li>
<li>通过内建网管支持推送时序数据</li>
<li>通过一系列发现或静态配置来获取目标</li>
<li>多种图形和仪表盘支持的模式</li>
</ul>
</div>
<div class="section" id="id5">
<h3>组件<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Prometheus 包含多个组件：</p>
<ul class="simple">
<li>主应用程序 Prometheus server 负责收集和存储时序数据</li>
<li>client libraries 客户端库程序负责集成到应用程序代码中</li>
<li>push gateway 推送网管支持短时间任务</li>
<li>特定用途的 exporters 用于诸如 HAProxy, StatsD, Graphite 等第三方服务</li>
<li>alertmanager 告警管理器用于处理警报</li>
<li>以及一系列工具</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>通过 PromQL 可以定义告警，并且只要能数据图表化，就能够基于图表进行告警。</p>
<p class="last">Prometheus性能极佳并且易于运行。一个单机运行的Prometheus能够每秒处理百万级别的样本数据。所有的Prometheus组件都能够容器化，这样就可以避免基于配置管理工具来维护。Prometheus自身也设计成集成到基础架构中，无需单独维护。</p>
</div>
</div>
<div class="section" id="id6">
<h3>架构<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<a class="reference internal image-reference" href="../_images/prometheus_architecture.png"><img alt="../_images/prometheus_architecture.png" src="../_images/prometheus_architecture.png" style="width: 675.5px; height: 405.5px;" /></a>
</div>
<p>Prometheus可以从编排任务中获取metrics，既支持直接获取也支持通过中间推送网管执行的短时间任务。所有抓取短样本都存储在本地并且基于这些数据运行归来在聚合或者从现有数据中记录下新的时序数据或生成告警。通常Prometheus会结合到 <a class="reference internal" href="grafana.html#grafana"><span class="std std-ref">Grafana 数据分析监控平台</span></a> 或者其他API消费者平台来可视化采集的数据。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>传统的监控系统，例如 <a class="reference external" href="https://www.nagios.org">Nagios</a> 是基于定时运行的检查脚本来检查服务异常返回值以确定是否告警；同时针对业务日志的监控和分析平台，例如Elasticsearh,Logstash和Kibana(ELK)提供了服务异常趋势分析。</p>
<p class="last">但是在云计算和云原生环境中，单独的服务判断已经无法反映系统的健康程度，而是在大量的虚拟化和容器化环境中，复杂的相互调用监控才能掌控整个架构。需要同时结合服务告警和趋势分析的监控平台逐步成为这种应用场景的监控需求，Prometheus恰到好处地结合 Docker / Kubernetes 内嵌的 <a class="reference internal" href="cadvisor.html#cadvisor"><span class="std std-ref">cAdvisor容器性能分析组件</span></a> ，实现了完整的监控体系。</p>
</div>
</div>
<div class="section" id="id7">
<h3>使用场景<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Prometheus适合做:
- 非常适合记录任何纯数字时序数据：Prometheus 适合基于主机监控和高度动态面向服务的架构。在微服务架构中，Prometheus支持多维度数据采集以及提供强大的查询能力
- 适合快速诊断系统问题：Prometheus服务器是独立部署的，不依赖网络存储或其他远程服务。这样即使其他系统架构异常，也不会影响到监控平台</li>
<li>Prometheus不适合做:
- 虽然Prometheus非常稳定，但是并不能保证数据百分百精确
- Prometheus不适合需要通过分析数据来记账的场景</li>
</ul>
</div>
</div>
<div class="section" id="id8">
<h2>参考<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://prometheus.io/docs/introduction/overview/">Prometheus Overview</a></li>
<li><a class="reference external" href="https://www.amazon.com/Prometheus-Infrastructure-Application-Performance-Monitoring-ebook-dp-B07FCV2VVG/dp/B07FCV2VVG/ref=mt_kindle?_encoding=UTF8&amp;me=&amp;qid=1560303117">Prometheus - Up &amp; Running: Infrastructure and Application Performance Monitoring</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="grafana.html" class="btn btn-neutral float-right" title="Grafana 数据分析监控平台" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cadvisor.html" class="btn btn-neutral float-left" title="cAdvisor容器性能分析组件" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../copyright.html">Copyright</a> 2019, Huatai Huang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <!-- your html code here -->
    <br>
    <p><a href="https://github.com/huataihuang/cloud-atlas/issues">留言和讨论</a>|<a href="https://github.com/huataihuang/cloud-atlas/blob/master/source/donate.rst">请我喝一杯咖啡</a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>